<!doctype html>
<html lang="fr" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-cours/r20" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Rencontre 20 - Planification de tâches | 420-3A5-EM - Automatisation de tâches</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://info.cegepmontpetit.ca/3A5-Automatisation/cours/r20"><meta data-rh="true" name="docusaurus_locale" content="fr"><meta data-rh="true" name="docsearch:language" content="fr"><meta data-rh="true" name="keywords" content="420-3A5-EM - Automatisation de tâches, Site de référence du cours d&#x27;automatisation de tâches&#x27;, informatique, technique, cégep, cegep, édouard-montpetit, edouard-montpetit, édouard montpetit, edouard montpetit"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Rencontre 20 - Planification de tâches | 420-3A5-EM - Automatisation de tâches"><meta data-rh="true" name="description" content="1. Planification de tâches"><meta data-rh="true" property="og:description" content="1. Planification de tâches"><link data-rh="true" rel="icon" href="/3A5-Automatisation/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://info.cegepmontpetit.ca/3A5-Automatisation/cours/r20"><link data-rh="true" rel="alternate" href="https://info.cegepmontpetit.ca/3A5-Automatisation/cours/r20" hreflang="fr"><link data-rh="true" rel="alternate" href="https://info.cegepmontpetit.ca/3A5-Automatisation/cours/r20" hreflang="x-default"><link rel="stylesheet" href="/3A5-Automatisation/assets/css/styles.04fe09d5.css">
<link rel="preload" href="/3A5-Automatisation/assets/js/runtime~main.181ed607.js" as="script">
<link rel="preload" href="/3A5-Automatisation/assets/js/main.dc4986b1.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Aller au contenu principal"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Aller au contenu principal</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Ouvrir/fermer la barre de navigation" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/3A5-Automatisation/"><div class="navbar__logo"><img src="/3A5-Automatisation/img/logo.svg" alt="Logo CEM" class="themedImage_ToTc themedImage--light_HNdA"><img src="/3A5-Automatisation/img/logo.svg" alt="Logo CEM" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">420-3A5-EM - Automatisation de tâches</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/3A5-Automatisation/cours/r01">Cours</a><a class="navbar__item navbar__link" href="/3A5-Automatisation/tp/tp1">Travaux Pratiques</a><a class="navbar__item navbar__link" href="/3A5-Automatisation/labo/labo-ad">Laboratoires</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Basculer entre le mode sombre et clair (actuellement mode clair)" aria-label="Basculer entre le mode sombre et clair (actuellement mode clair)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Retour au début de la page" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r01">R01 - Accueil</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r02">R02 - Objets et pipeline</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r03">R03 - Collections et types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r04">R04 - Dictionnaires</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r05">R05 - Scripts PowerShell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r06">R06 - Paramètres et fonctions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r07">R07 - Fichiers et strings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r08">R08 - Erreurs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r09">R09 - Utilisateurs locaux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r10">R10 - Travail sur le TP1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r11">R11 - Portée (et travail sur le TP1)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r12">R12 - Travail sur le Tp1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r13">R13 - Révision pour l&#x27;intra</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r14">R14 - EXAMEN INTRA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r15">R15 - Le registre de Windows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r16">R16 - WMI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r17">R17 - Active Directory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r18">R18 - Laboratoire AD</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r19">R19 - Administration à distance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/3A5-Automatisation/cours/r20">R20 - Planification de tâches</a></li></ul></nav><button type="button" title="Réduire le menu latéral" aria-label="Réduire le menu latéral" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Fil d&#x27;Ariane"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Page d&#x27;accueil" class="breadcrumbs__link" href="/3A5-Automatisation/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">R20 - Planification de tâches</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Sur cette page</button></div><div class="theme-doc-markdown markdown"><h1>Rencontre 20 - Planification de tâches</h1><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Résumé de la séance</div><div class="admonitionContent_S0QG"><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">👨‍🏫 Déroulement du cours</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">💻 Exercices à compléter</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">📚 Ressources à consulter</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><ol><li>Planification de tâches</li><li>TP2</li></ol></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><ul><li>TP2</li></ul></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>La présentation PowerPoint est sur le Teams du cours, sous le canal Général &gt; Fichiers &gt; Supports de cours.</p></div></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="le-planificateur-de-tâches">Le planificateur de tâches<a href="#le-planificateur-de-tâches" class="hash-link" aria-label="Lien direct vers Le planificateur de tâches" title="Lien direct vers Le planificateur de tâches">​</a></h2><p>Le planificateur de tâches sert, comme son nom l&#x27;indique, à planifier des opérations sous Windows afin qu&#x27;elles démarrent automatiquement selon certains critères et dans certaines conditions. Il est très utile dans de nombreux contextes, comme la planification de tâches de maintenance régulières, le démarrage d&#x27;opérations automatique au démarrage du système ou à l&#x27;ouverture d&#x27;une session utilisateur, le nettoyage automatique de fichiers temporaires, la prise de sauvegardes régulières, etc.</p><p>Avec l&#x27;interface graphique, on utilise la console MMC du planificateur de tâches, <code>taskschd</code>, ou encore la console de gestion de l&#x27;ordinateur, <code>compmgmt.msc</code>.</p><p><img loading="lazy" src="/3A5-Automatisation/assets/images/taskschd_01-083757c0f53310935feb5cdd4e98ea8d.png" width="448" height="252" class="img_ev3q"></p><p>Les tâches planifiées sont organisées sous forme d&#x27;arborescence. La racine (nommée &quot;bibliothèque du planificateur de tâches&quot;, ou simplement, <strong>/</strong>) contient un certain nombre de tâches planifiées déjà mises en place à l&#x27;installation de Windows ou d&#x27;un logiciel, mais d&#x27;autres tâches sont stockées dans des conteneurs sous la racine.</p><p><img loading="lazy" src="/3A5-Automatisation/assets/images/taskschd_02-56d205cd86506626b5a50f4fbd96e63b.png" width="572" height="446" class="img_ev3q"></p><p>Pour créer une tâche à l&#x27;aide de l&#x27;interface graphique, il suffit d&#x27;ouvrir le menu contextuel par un clic-droit sur le conteneur où créer la tâche. Il existe deux manière de créer une tâche: simplifiée (&quot;<em>créer une tâche de base...</em>&quot;) et avancée (&quot;<em>créer une tâche...</em>&quot;). Il est préférable de ne pas choisir une tâche de base, puisque certaines options sont inaccessibles.</p><p><img loading="lazy" src="/3A5-Automatisation/assets/images/taskschd_03-dd911f0b064bd012be01833832e1b049.png" width="486" height="422" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="composition-dune-tâche-planifiée">Composition d&#x27;une tâche planifiée<a href="#composition-dune-tâche-planifiée" class="hash-link" aria-label="Lien direct vers Composition d&#x27;une tâche planifiée" title="Lien direct vers Composition d&#x27;une tâche planifiée">​</a></h3><p>Une tâche planifiée est en ensemble de plusieurs éléments d&#x27;information. Ils sont assemblés ensemble pour former une tâche planifiée incrite dans le planificateur.</p><p><img loading="lazy" src="/3A5-Automatisation/assets/images/taskschd_05-9a17c24b66a27486d7717196943ce633.png" width="371" height="270" class="img_ev3q"></p><ul><li><p>L&#x27;information d&#x27;enregistrement (<strong>RegistrationInfo</strong>) contient les propriétés de la tâche qui concernent son enregistrement dans le planificateur, comme le nom de la tâche, sa description et son emplacement dans l&#x27;arborescence du planificateur.</p></li><li><p>Les déclencheurs (<strong>Trigger</strong>) définissent dans quelle circonstance la tâche pourra être lancée. Par exemple, au démarrage de l&#x27;ordinateur, à l&#x27;ouverture de session, à chaque vendredi minuit, ou même lorsqu&#x27;un événement système est détecté. Il peut y en avoir plus d&#x27;un.</p></li><li><p>Les actions (<strong>Action</strong>) définissent une action (comme le lancement d&#x27;une commande ou d&#x27;un script) à exécuter chaque fois que la tâche est déclenchée. Il peut y en avoir plusieurs.</p></li><li><p>Le principal de sécurité (<strong>Principal</strong>) décrit avec quelle identité (un compte utilisateur ou un groupe) la tâche sera lancée. Si le principal est un compte utilisateur, alors c&#x27;est sous ce compte que la tâche sera exécutée (comme si l&#x27;utilisateur l&#x27;avait fait manuellement). Si le principal est un groupe, la tâche sera lancée au nom de l&#x27;utilisateur courant uniquement s&#x27;il est membre de ce groupe.</p></li><li><p>Les paramètres (<strong>Settings</strong>) décrivent diverses options concernant la tâche. Par exemple, la tâche doit-elle être exécutée même si l&#x27;ordinateur tourne sur la batterie, ou le comportement à adopter si la tâche échoue.</p></li></ul><p><img loading="lazy" src="/3A5-Automatisation/assets/images/taskschd_04-1a8d02d3a5e551dbe924eb3e1953b1f2.png" width="808" height="490" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="planification-dune-tâche-gui">Planification d&#x27;une tâche (GUI)<a href="#planification-dune-tâche-gui" class="hash-link" aria-label="Lien direct vers Planification d&#x27;une tâche (GUI)" title="Lien direct vers Planification d&#x27;une tâche (GUI)">​</a></h2><p>Voici les éléments importants à configurer pour créer une tâche planifiée au moyen de l&#x27;interface graphique.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="déclencheur-trigger">Déclencheur (<em>Trigger</em>)<a href="#déclencheur-trigger" class="hash-link" aria-label="Lien direct vers déclencheur-trigger" title="Lien direct vers déclencheur-trigger">​</a></h3><p>Une tâche planifiée comprend un ou plusieurs déclencheurs, c&#x27;est-à-dire des événements qui démarreront automatiquement la tâche.</p><p><img loading="lazy" src="/3A5-Automatisation/assets/images/taskschd_trigger01-b0804a68d3ce0316080f1a7b63836829.png" width="856" height="534" class="img_ev3q"></p><p>Plusieurs types de déclencheurs sont disponibles:</p><ul><li>À l&#x27;heure programmée</li><li>À l&#x27;ouverture de session</li><li>Au démarage</li><li>Après une période d&#x27;activité </li><li>Sur un événement (système)</li><li>Lors de la création/modification de la tâche</li><li>Au moment de la connexion à une session utilisateur (par exemple, RDP)</li><li>Au moment de la déconnexion à une session utilisateur</li><li>Au verrouillage du poste de travail (Win+L)</li><li>Au déverrouillage du poste de travail</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="action-action">Action (<em>Action</em>)<a href="#action-action" class="hash-link" aria-label="Lien direct vers action-action" title="Lien direct vers action-action">​</a></h3><p>Une tâche planifiée comprend une ou plusieurs actions qui seront lancées lorsque la tâche sera déclenchée. Le principal type d&#x27;action est le lancement d&#x27;une commande (&quot;<em>démarrer un programme</em>&quot;).</p><p><img loading="lazy" src="/3A5-Automatisation/assets/images/taskschd_action01-7000678738875d6441dedd82e6bcdcd7.png" width="642" height="246" class="img_ev3q"></p><p>Pour lancer une commande, il faut définir trois paramètres:</p><table><thead><tr><th>Paramètre</th><th>Description</th></tr></thead><tbody><tr><td>Programme/script</td><td>Le nom ou chemin du fichier exécutable à appeler seulement.</td></tr><tr><td>Ajouter des arguments (facultatif)</td><td>Tous les arguments après le nom de l&#x27;exécutable.</td></tr><tr><td>Commencer dans (facultatif)</td><td>Le répertoire de travail dans lequel lancer la commande.</td></tr></tbody></table><p>Par exemple, pour qu&#x27;une tâche exécute le script PowerShell <code>C:\Scripts\MonScript.ps1</code>, il faudrait que le nom du programme soit <code>powershell.exe</code> et que les arguments soient <code>-File C:\Scripts\MonScript.ps1 -ExecutionPolicy Bypass</code>.</p><p><img loading="lazy" src="/3A5-Automatisation/assets/images/taskschd_action02-8ebfbbf359478f172106f7c37269709c.png" width="464" height="299" class="img_ev3q"></p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>astuce</div><div class="admonitionContent_S0QG"><p>Pour connaître la syntaxe de la commande Powershell.exe, vous pouvez lancer <code>Powershell.exe /?</code> pour accéder à la rubrique d&#x27;aide.</p><p><img loading="lazy" src="/3A5-Automatisation/assets/images/taskschd_action03-05a32e074505d251f1289f42f4db7498.png" width="730" height="281" class="img_ev3q"></p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="conditions-et-paramètres">Conditions et paramètres<a href="#conditions-et-paramètres" class="hash-link" aria-label="Lien direct vers Conditions et paramètres" title="Lien direct vers Conditions et paramètres">​</a></h3><p>Les onglets Conditions et Paramètres contiennent des options supplémentaires sur la tâche.</p><p><img loading="lazy" src="/3A5-Automatisation/assets/images/taskschd_condition01-92ea24c0d9d242fe1b1678d3faeda799.png" width="587" height="448" class="img_ev3q"></p><p><img loading="lazy" src="/3A5-Automatisation/assets/images/taskschd_parameters01-5f312503b665086d8c02d9009e6f02b0.png" width="587" height="448" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="forcer-le-lancement-une-tâche-planifiée">Forcer le lancement une tâche planifiée<a href="#forcer-le-lancement-une-tâche-planifiée" class="hash-link" aria-label="Lien direct vers Forcer le lancement une tâche planifiée" title="Lien direct vers Forcer le lancement une tâche planifiée">​</a></h3><p>On peut forcer l&#x27;exécution d&#x27;une tâche planifiée directement par la console. C&#x27;est pratique pour la tester.</p><p><img loading="lazy" src="/3A5-Automatisation/assets/images/taskschd_forceexec-605db66f9dce228b23b516bc841f9e30.png" width="1018" height="360" class="img_ev3q"></p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>astuce</div><div class="admonitionContent_S0QG"><p>Comme bien des consoles MMC, vous pouvez gérer les tâches planifiées sur une machine distante à partir de la console. Vous devez être administrateur local de la machine distante, et les pare-feux doivent laisser passer le protocole MSRPC.</p><p><img loading="lazy" src="/3A5-Automatisation/assets/images/taskschd_remote-36e7cf26e7430cd882f9875cb53b6d63.png" width="592" height="431" class="img_ev3q"></p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="gestion-des-tâches-planifiées-en-powershell">Gestion des tâches planifiées en PowerShell<a href="#gestion-des-tâches-planifiées-en-powershell" class="hash-link" aria-label="Lien direct vers Gestion des tâches planifiées en PowerShell" title="Lien direct vers Gestion des tâches planifiées en PowerShell">​</a></h2><p>PowerShell offre un ensemble de commandes pour contrôler, localement ou à distance, les tâches planifiées.</p><p>Pour ce faire, il y a plusieurs commandes à faire, puisqu&#x27;il faut créer chaque élément de la tâche planifiée individuellement, puis les mettre ensemble pour l&#x27;enregistrer dans la bibliothèque du planificateur de tâches.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="définir-le-déclencheur">Définir le déclencheur<a href="#définir-le-déclencheur" class="hash-link" aria-label="Lien direct vers Définir le déclencheur" title="Lien direct vers Définir le déclencheur">​</a></h3><p>Il existe plusieurs déclencheurs. Il suffit ici de créer un nouveau déclencheur du type souhaité. Il faut le stocker dans une variable.</p><p><img loading="lazy" src="/3A5-Automatisation/assets/images/taskschd_posh_newtrigger-2a4df83a3f2aedbd6a68dc8dd513c4ac.png" width="730" height="235" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="définir-laction">Définir l&#x27;action<a href="#définir-laction" class="hash-link" aria-label="Lien direct vers Définir l&#x27;action" title="Lien direct vers Définir l&#x27;action">​</a></h3><p>Il faut définir l&#x27;action, soit le programme a exécuter. Tout comme avec l&#x27;interface graphique, le programme à spécifier dans le paramètre -Execute n&#x27;est que l&#x27;exécutable à lancer. Si c&#x27;est un script PowerShell, alors on met &quot;powershell.exe&quot;. Si c&#x27;est un autre programme, on met uniquement le nom du programme, sans ses arguments.</p><p><img loading="lazy" src="/3A5-Automatisation/assets/images/taskschd_posh_newaction-bfed654b1bc0efd5baa42f035aea0429.png" width="730" height="236" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="définir-le-principal">Définir le principal<a href="#définir-le-principal" class="hash-link" aria-label="Lien direct vers Définir le principal" title="Lien direct vers Définir le principal">​</a></h3><p>Le principal désigne l&#x27;utilisateur au nom duquel la tâche sera exécutée.</p><p>Nous avons deux options:</p><ul><li>Spécifier un compte utilisateur spécifique (<code>-UserID</code>)</li><li>Spécifier un groupe (<code>-GroupID</code>)</li></ul><p><img loading="lazy" src="/3A5-Automatisation/assets/images/taskschd_posh_newprincipal-f2f891a7988f86454900f958ff4f0a29.png" width="730" height="266" class="img_ev3q"></p><p>Si le principal est un utilisateur, la tâche sera faite au nom de ce compte précis.</p><p>Si le principal est un groupe, la tâche sera faite au nom de l&#x27;utilisateur courant, uniquement si celui-ci fait partie du groupe. Lorsque le principal est un groupe, il est impossible que la tâche soit lancée lorsque l&#x27;utilisateur n&#x27;est pas loggé.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="enregistrer-la-tâche-planifiée">Enregistrer la tâche planifiée<a href="#enregistrer-la-tâche-planifiée" class="hash-link" aria-label="Lien direct vers Enregistrer la tâche planifiée" title="Lien direct vers Enregistrer la tâche planifiée">​</a></h3><p>Une fois tous les éléments en place, il ne reste plus qu&#x27;à enregistrer la tâche planifiée. On lui donne alors un nom, une description et un emplacement dans le planificateur, puis on lui donne une ou plusieurs actions, un ou plusieurs déclencheurs ainsi qu&#x27;un principal.</p><p><img loading="lazy" src="/3A5-Automatisation/assets/images/taskschd_posh_register-5eaa05a642ff6ffa5511c846858d32cc.png" width="729" height="181" class="img_ev3q"></p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>astuce</div><div class="admonitionContent_S0QG"><p>Il est aussi possible de contrôler les tâches planifiées sur un ordinateur distant. On peut simplement passer par une session distante (PSSession) au moyen de la commande Invoke-Command.</p><p><img loading="lazy" src="/3A5-Automatisation/assets/images/taskschd_posh_remote01-ef50b093f8354149583ef12a4eb6bcb9.png" width="570" height="270" class="img_ev3q"></p></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Pages de documentation"><a class="pagination-nav__link pagination-nav__link--prev" href="/3A5-Automatisation/cours/r19"><div class="pagination-nav__sublabel">Précédent</div><div class="pagination-nav__label">Rencontre 19 - Administration à distance</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#le-planificateur-de-tâches" class="table-of-contents__link toc-highlight">Le planificateur de tâches</a><ul><li><a href="#composition-dune-tâche-planifiée" class="table-of-contents__link toc-highlight">Composition d&#39;une tâche planifiée</a></li></ul></li><li><a href="#planification-dune-tâche-gui" class="table-of-contents__link toc-highlight">Planification d&#39;une tâche (GUI)</a><ul><li><a href="#déclencheur-trigger" class="table-of-contents__link toc-highlight">Déclencheur (<em>Trigger</em>)</a></li><li><a href="#action-action" class="table-of-contents__link toc-highlight">Action (<em>Action</em>)</a></li><li><a href="#conditions-et-paramètres" class="table-of-contents__link toc-highlight">Conditions et paramètres</a></li><li><a href="#forcer-le-lancement-une-tâche-planifiée" class="table-of-contents__link toc-highlight">Forcer le lancement une tâche planifiée</a></li></ul></li><li><a href="#gestion-des-tâches-planifiées-en-powershell" class="table-of-contents__link toc-highlight">Gestion des tâches planifiées en PowerShell</a><ul><li><a href="#définir-le-déclencheur" class="table-of-contents__link toc-highlight">Définir le déclencheur</a></li><li><a href="#définir-laction" class="table-of-contents__link toc-highlight">Définir l&#39;action</a></li><li><a href="#définir-le-principal" class="table-of-contents__link toc-highlight">Définir le principal</a></li><li><a href="#enregistrer-la-tâche-planifiée" class="table-of-contents__link toc-highlight">Enregistrer la tâche planifiée</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Sources</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/departement-info-cem/3A5-Automatisation" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Vincent Carrier. Tous droits réservés.</div></div></div></footer></div>
<script src="/3A5-Automatisation/assets/js/runtime~main.181ed607.js"></script>
<script src="/3A5-Automatisation/assets/js/main.dc4986b1.js"></script>
</body>
</html>
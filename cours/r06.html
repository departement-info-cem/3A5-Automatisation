<!doctype html>
<html lang="fr" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-cours/r06">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Rencontre 6 - Paramètres et fonctions | 420-3A5-EM - Automatisation de tâches</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://info.cegepmontpetit.ca/3A5-Automatisation/cours/r06"><meta data-rh="true" name="docusaurus_locale" content="fr"><meta data-rh="true" name="docsearch:language" content="fr"><meta data-rh="true" name="keywords" content="420-3A5-EM - Automatisation de tâches, Site de référence du cours d&#x27;automatisation de tâches&#x27;, informatique, technique, cégep, cegep, édouard-montpetit, edouard-montpetit, édouard montpetit, edouard montpetit"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Rencontre 6 - Paramètres et fonctions | 420-3A5-EM - Automatisation de tâches"><meta data-rh="true" name="description" content="1. Paramètres de scripts"><meta data-rh="true" property="og:description" content="1. Paramètres de scripts"><link data-rh="true" rel="icon" href="/3A5-Automatisation/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://info.cegepmontpetit.ca/3A5-Automatisation/cours/r06"><link data-rh="true" rel="alternate" href="https://info.cegepmontpetit.ca/3A5-Automatisation/cours/r06" hreflang="fr"><link data-rh="true" rel="alternate" href="https://info.cegepmontpetit.ca/3A5-Automatisation/cours/r06" hreflang="x-default"><link rel="stylesheet" href="/3A5-Automatisation/assets/css/styles.e683f185.css">
<link rel="preload" href="/3A5-Automatisation/assets/js/runtime~main.1edb1c17.js" as="script">
<link rel="preload" href="/3A5-Automatisation/assets/js/main.9a7af7e9.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Aller au contenu principal"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Aller au contenu principal</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Ouvrir/fermer la barre de navigation" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/3A5-Automatisation/"><div class="navbar__logo"><img src="/3A5-Automatisation/img/logo.svg" alt="Logo CEM" class="themedImage_ToTc themedImage--light_HNdA"><img src="/3A5-Automatisation/img/logo.svg" alt="Logo CEM" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">420-3A5-EM - Automatisation de tâches</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/3A5-Automatisation/cours/r01">Cours</a><a class="navbar__item navbar__link" href="/3A5-Automatisation/tp/tp1">Travaux Pratiques</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Basculer entre le mode sombre et clair (actuellement mode clair)" aria-label="Basculer entre le mode sombre et clair (actuellement mode clair)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Retour au début de la page" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r01">R01 - Accueil</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r02">R02 - Objets et pipeline</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r03">R03 - Collections et types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r04">R04 - Dictionnaires</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r05">R05 - Scripts PowerShell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/3A5-Automatisation/cours/r06">R06 - Paramètres et fonctions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r07">R07 - Fichiers et strings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r08">R08 - Erreurs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r09">R09 - Utilisateurs locaux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r10">R10 - Travail sur le TP1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r11">R11 - Portée (et travail sur le TP1)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/3A5-Automatisation/cours/r12">R12 - Travail sur le Tp1</a></li></ul></nav><button type="button" title="Réduire le menu latéral" aria-label="Réduire le menu latéral" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Fil d&#x27;Ariane"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Page d&#x27;accueil" class="breadcrumbs__link" href="/3A5-Automatisation/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">R06 - Paramètres et fonctions</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Sur cette page</button></div><div class="theme-doc-markdown markdown"><h1>Rencontre 6 - Paramètres et fonctions</h1><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Résumé de la séance</div><div class="admonitionContent_S0QG"><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">👨‍🏫 Déroulement du cours</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">💻 Exercices à compléter</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">📚 Ressources à consulter</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><ol><li>Paramètres de scripts</li><li>Fonctions</li><li>Validations de paramètres</li></ol></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><ul><li>Exercice 05a - Paramètres d&#x27;un script</li><li>Exercice 05b - Fonctions</li><li>Exercice 05c - Validation de paramètres</li></ul></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>La présentation PowerPoint est sur le Teams du cours, sous le canal Général &gt; Fichiers &gt; Supports de cours.</p></div></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="les-scripts-et-le-pipeline">Les scripts et le pipeline<a href="#les-scripts-et-le-pipeline" class="hash-link" aria-label="Lien direct vers Les scripts et le pipeline" title="Lien direct vers Les scripts et le pipeline">​</a></h2><p>Lorsqu’il est démarré dans une session PowerShell, un fichier de script (.ps1) se comporte exactement comme une commande:</p><ul><li>Il retourne des objets sur le pipeline</li><li>Il admet des objets en entrée du pipeline</li><li>Il permet de spécifier des arguments</li></ul><p>Par exemple, voici un script <code>MonScript.ps1</code> situé dans le répertoire <code>C:\Scripts</code>. </p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token variable" style="color:rgb(9, 134, 88)">$reponse</span><span class="token plain"> = </span><span class="token function" style="color:rgb(0, 0, 255)">Read-Host</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Prompt </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Entrez le nom d&#x27;un service&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$reponse</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Get-Service</span><span class="token plain">   </span><span class="token comment" style="color:rgb(0, 128, 0)"># Renvoie le service dans le pipeline</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>À la fin de l&#x27;exécution du script, un ou des objets sont envoyés sur le pipeline, résultat de <code>Get-Service</code>. Ces objets sortent donc du script comme s&#x27;il s&#x27;agissait d&#x27;une commande. Si on ne fait rien avec, les objets sont convertis en texte et affichés dans la console, mais on peut les intercepter en chaînant une autre commande dans le pipeline.</p><p><img loading="lazy" alt="image" src="/3A5-Automatisation/assets/images/r06_01a-e8df77d1cc441ec0f9dea52925be4b2a.png" width="697" height="344" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="paramètres-dun-script">Paramètres d&#x27;un script<a href="#paramètres-dun-script" class="hash-link" aria-label="Lien direct vers Paramètres d&#x27;un script" title="Lien direct vers Paramètres d&#x27;un script">​</a></h2><p>Un script peut admettre un ou plusieurs paramètres pour modifier son fonctionnement. On peut déclarer les paramètres dans un bloc <code>param()</code>, qui doit se trouver obligatoirement <strong>au tout début</strong> du script.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">param</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[double]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Param1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[string]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Param2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[int[]]</span><span class="token plain">  </span><span class="token variable" style="color:rgb(9, 134, 88)">$Param3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[switch]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Param4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>On y déclare les paramètres sous forme de variables typées. Le nom de la variable représente le nom du paramètre, et l&#x27;ordre de déclaration des paramètres devient sa position (lorsqu&#x27;on ne spécifie pas son nom à l&#x27;appel).</p><p>Lorsque le script sera appelé, les arguments spécifiés meubleront les variables qui leur sont associées, et on pourra les utiliser dans le script.</p><p>Par exemple, ce script, <code>division.ps1</code> prend en paramètre deux nombres, un dividende et un diviseur, effectue la division de ces deux nombres, et jette le résultat dans le pipeline.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">param</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[double]</span><span class="token variable" style="color:rgb(9, 134, 88)">$Dividende</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[double]</span><span class="token variable" style="color:rgb(9, 134, 88)">$Diviseur</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$Dividende</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Diviseur</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="image" src="/3A5-Automatisation/assets/images/r06_01b-2109293931b827450d495942c447022f.png" width="697" height="187" class="img_ev3q"></p><p>On remarquera aussi que PowerShell est conscient des paramètres déclarés dans le script car il nous permet de les compléter avec la touche de tabulation ou avec <code>Ctrl+Espace</code>.</p><p><img loading="lazy" alt="image" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAArkAAACHCAYAAAASsUFAAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH5wkKEwIpy9zkSAAAH6xJREFUeJzt3X1YlGXeN/DvoIZviCKvSqICoiiGSi8La+KauCwLVoTE04Sk6KPlrewt6hGmWYS7rbqStxlPqbcaxy1IPpu6RFKuGGEvoo6QJAEqOjgIgi8ooMLM/cc4lzPAvDHD2/D9HAdHzFzXeV7nTH/07cfvOi8RAAWIiIiIiCxIXwCYPHlyV6+DiIiIiMgsCgoKYNXViyAiIiIiMjeGXCIiIiKyOAy5RERERGRxGHKJiIiIyOIw5BIRERGRxWHIJSIiIiKL07c9gxQKBRQKBeRyORQKbrNL1NWsrKwgEomEHyIiot7OqJCrUCjQ3NyM2822qFcMwn2FNRoUgzpqbURkoIGie7AWNWKg6C6G9KlDnz59GHaJiKhXMzjkyuVyPGgWQdbkhrsKm45cExEZqV4xCPWKQbiJ4ahT3IYzrqGflRxWVuxIIiKi3smg/wIqFArcb7bCxSYvBlyibu6O3BYXH3rgoVzEdiIiIuq1DAq5zc3NqGwaiWYFq0JEPUGToh8qm0agubm5q5fSiq2tbVcvgYiIegG9qVWhUOB2sy0ruEQ9zB25Le7KbSCXy7t6KURERJ3OoJB7D4M7Yy1EPV9Xdge0ce178sFsWSAiol5J741nCoUCjc0DO2MtRGSKNjZTaFT07/x1EBFRhzp37pxB5z311FMdvBLjZGRkYOfOnTh69Gibx+fMmYPY2FhERESY5Xp6Q65cLscDWJvlYkQWr5vt2tWoGMBKLhGRBdIXYA0Nwp1p586dSEhIAIBWQXfOnDlISEjAxo0bzXY9g7YQ438iiXomOawYcomIqFtQBduWQVc94Gqr8rZHu554povTyPFw9Xz20SsRIBIBePQUJpEIImi+hkiEpqaHOPPvneZeChF1gI8++ggAsGLFii5eCRER9TQtg67qd3MHXKADQu6YSTMxYtwMPDMWUMib8WPJAyiamyCXP4RC3gxF80PI5U1QyJsgb1b+s681b2yj3icyxB8AkJ55sl3HiYjIND21t7Wnaxl0OyLgAgbuk2uovv2sMczRHVAoEOILrAnri5neokehtlkZbOXNj35//FN3+7rB1yj+JhnF3yRrvFd9aieu5O4QXruNdIC8JB3b1r+ByBB/7Nu8zOjPsjw6GPKSdCyPDjZ6bHuorqf6uZK7o9OurS4yxB+SI5s01gEAX6asgrwk3ej55CXp+DJlVavfSWn7hgVCmFUXGeKP7RsWdMGKiIh6j6eeesqgH+qZzFrJtbUbgX4DhkIhb8au481InGeNN563QsnVh7hU1SxUcJVh9/Hvt25IDb7Gr2UVCJvlJ7yODPHHAOsnMHzo4318F0TMBABkfPUDFr36Al4OegbR5vuYHSr1UC7yC8rwamgANsZH4dCxfJRXVHfa9bdvWIDaW3cRl7gHALAg4g+ddu3eRlWhVYVZ1WtVwF22YXevruLa2Nigrq6uq5dBRERm1vImM203o5nKrJXcoQ5u6NOvP+TyJlysfIi1/1MHqz5P4G/RDhjjYKVWzX1c2RX16YfayhKDr7H/SB4ACFXOkJlTUXG9VuO9p8a7oeZWHXLzLyA6fjsGT+4pERfILyjDtn1ZiIr7CAMHWGOuWqDvDMOH2iAt8yS27cvCtn1Z8A1l5bUjpWeexLINu4WKLgPuY8nJyRCLxa3eF4vFOHDgQBesiIiITNXyJrOjR49i48aNSEhIwJw5c8x6LbNWch1dvTUqtGWVTfgg4yH++vpw/G2+I8LWn0XffgMf9eYqg26/AUNx41qxwddIzzyJXX9dgj/4T8K2fVmY7OWGX8sqMKD/E8J7E9xHouRyJQAIrQ1es+PwZcoqhM3yw/bPv8aCV5TV3t1fHMfy9/8bAPDN3nWY5T8J9Q33UVB8ReO678XNwxvhgXB1Ho76hvv49mQhXlyyCZIjm1DfeB/+Ee9gut94nNj/HlIP5SI6fju+TFmFqRPHYNT0N/Flyiq84O+DgQOsUXDhilHhMTLEH28veQmTx48CAPwoKUFU3Ed4ztcT+5NXYEbUu8jNv4CTGR9gstcoIdTLS9KR+PFB7M44jv3JK/CcrycA4NjJXzB7fqLwfRw+lo+wWX6IS9yDkssyrFzwZwwbMkj4XtRtW/9Gm9+d+ucruSxDUExSp1age7KWFd3uFHBVN5mpGzt2rNZj5rwZLS4uDrt27QIApKamAlAG3Ndeew0LFy4023WIiKhzaNtFQduuC6YyWyW3bz9rDHUYo9FrO8bBCouChgAAii7K0HBH1qpl4V5dLR7ev2fUtUrLr2P0SEcAgIebE/598hcUX5RhgvtIAIDnaBd8k1egdfyoEfaYGLwSpeXXERUaAEAZ3mb5T0Jc4h5MDF6pcf50v/FY91Y4zpy/hDGBy7Bl978QNssP29a/gYLicniOdgYARPzpd6hvuI/JXm4AgAnuI3Hm/CUsjw5G2Cw/bNn9L1h5RhoUcPcnr0B9w30cOpYvhJ8ZUe8iKu4jeI52xv7kFUjPPIn6hvuI+NPvHn1u5ToiQ/yFqva7yQewP3kFBva3xpjAZZgR9S5+N8UT29a/oXE9K89IbNuXhaCYJJSWX8ey1/+IK7k7WvWLTnB3Fb47Vdjdtv4NBEzzQvCCjRgTuExYP5Ep6urqsHDhQoSFhUEsFmsE3GvXrnX18oiIutS5c+d0/nRHsbGxWm8yU1V0Y2NjzXY9s1Vyh9k/iT79BgoBNtTPGotmK/tkP9zzHf55shaDh41ucdNZE27dMr7aV1BcjpeDnkFkiD8GDrDGtn1ZGG5ng1n+4UIo251xXOv4F5dsAgBcrqgSqqNzpj+FkssybNuXBQBIO5InVD5XxoZqjHs3+QBeDfHH80974z/e2wXx3OmY7jcezz/tjW9PFuIFfx8AyrC9PvkAfpSUYGN8FN58LQjDhgzCll3/0lrlTF4Xg+R1MahvuI+Fb6dg7iw/DB9qg8T/Oojc/AsAgKjQAOEaBcVX4OfjjsgQfzQ0PkBF5U2EzJyKIYMHoOCCshqt+hyXcrYL1xk1wl74fcWj/lsAKK+ohm/oKiyPDkb8olDs+usS/Ch53E4ye35im9/d8KE2OLH/vccf5LJM6/dPmtRbFIDWPbpdqa3KbGduIaYKurt27YKNjQ0DLhEReu5uD/qeZKZqXzAXs4XcoY5jIOrTDwP7NWPFizZ4bpw1LlyuxvqUHDi5jMFbkROgUMgBhRwKhRy556pwqaovamU/GX2tzONnIJ47HW8veQklj8LU7ozjWPdWON5e8hKklTWd9qfy3PwLqLlVh4g//Q4ebk7wDV2FuwX7sG39G6i5VScElYnBK5H4l0hEhQbgxdlPY9T0N9ucL/VQLjKPnxHG6dthIb+wDFGhAQiZORVnzl/CnbsNQiX5u1NFwnmHj+ULIV1FtdNBW9+VKuwnr4sxqC+45LIMXrPj9J5HmrT14HanoNvV6urqMG/ePN6IRkRERjFbu4K9ixcU8iaE+VnjuXHWSP1KgqV/z8Etqwl4ZpIbXp/lgOgXnBA92wXzg0ZinFM9+g0YiuqKIv2Tt5CeeRI1t+rg4eaEX8sqACiDmrSyBh5uTii+aHwV8deyCox0ssPy6GBM9xuvsavAlp1HAChDodtIB7wXNw+eo11w6NgpAICkqBxRoQEoLVduhVZQfAVRoQFCX7BqfdHx25F1QgJX5+Fa15FfUKYRbLbty0LNrTosiPgDpvuNR2SIPwKmeeGHs8rq6pZd/8LwoTYInuGL/Ufy8Fnat/Bwc4KHmxMyvvpBuZ4LVxAwzQvT/cYDAPZtXqY1PJ/M+ADLo4OxPDoYrz5q5ThbdEnnd/fTuVJ4jnYR5lweHdyubdt6G20Bt+XNaKTEgEtERMYwWyXXdviTUMib8I2kDpnH8nC5xgqD7CZDIW/Cvm+u4YezF9Dc1AgoFLhzrxFl1xrQf6i10f24KiWXK/Gcryf+ffIX4b3iizLM8p+Ek2cNv5FNZUXiHmTvWYvkdTGouVWHrBMS4c/xufkXkPjxQbz5WhAu5WxHza06pB7KxbvJyju8jxzLxyz/Scg6IQGgrK4+5+uJHXnZAJRhRtWjWnOrDts//9qotS3bsBvvx83Dif3vob7hPn44W4LYhBQAyvBcclmGkU52QlBquP8ADY0PhPaGuUv+jkMpq4V2goILV7Buazr+4D+p1bUG9rdG8roYAIC0sgaJHyvbJFQtG22Jjt8OF4dh2BgfheR1MZBW1mDV31KN+oy9lbabzFjBJSIiMo0IgGLy5MlaT3j48CEuPPTRO5Hv7/8P+vUfrHxcL6yUM0MEkep3kQgikWbhWHb5HMp/zTFh+USkz/h+hejXr5/Z5jO1J9fW1ha3b98223qIiIhaKigoMF8lV/L9/5hrKiLqxjrjhjMiIiJTmfVhEERERERE3QFDLhERERFZHIZcInNSdPUCiIiICGDIJTIvUVcvgIiIiACGXKKO0akVXZaP9VEo+B0REfU2OkOuQqFAE57orLUQWY5OrejqvphCZLZNVMyiK7YPU25tSEREvYnekFuvGNxZayGiDlCvGAy5XN7VyyAiIupUbYZchUIBuVyOB81WqGp27uw1EZEZVTa5oEkuYtAlIqJepS+gfKqZuiZFX9QrBuN68wg0o0+XLIyIzOOhoi8uPvSEY59rGIB76Ctq6uolERERdbi+AAx6bC8R9VwPFX1R0TSqq5dBRETUSX7l7gpEREREZHkYcomIiIjI4jDkEhEREZHFYcglIiIiIovDkEtEREREFochl4iIiIgsDkMuEREREVmc7vVQeyLqcKfSVnf1EgRPv/r3rl4CERFZKFZyiYiIiMjiMOQSERERkcXpcSE3c8dShM7o3McQe7s741TaaqxbEtyp1zWX8qNzsPAlt3aNfdZnGBpPz8WepGndepylG+XQH6teHo1gP/sOGRcYGAipVGrKEjtlTiIiIkMZ1JPbsofvcE4hElOyAAChM3ywfunj8FdVW4eQNz8x6OJ7k6Lh7e4svP7sYB4+zcjTOebQ8QK8EjQFR04UtjpmyloMcb3mjlHn702KRp6kTO9n6mifZ17Fksix2PXPco33P1jujfj5nhrvzYj5Dj8V3mw1h/R6Q7uu3dnjOkv50Tlwsu+PtK+liFl72qS5pk8chue8bDXeS8+txJXqxlbn3m1obtc12juOiIiopzL4xrP5a/ehqKwS3u7O2JsUjes1d/D9mTKsXxqM9z/JajN06rI3KRqA8TeefJqRh7kzJ8Pb3RlFZZXC+97uzu1eiz5FZZWddoPM1jXhAIC/fHjQbHO+s60Ir4c8iWd9hrUKsIUld/D0q8cBKEPviT3PawTdnwpvov+0Q0Zfs7PHdabG03Px1gcSLIkca7Y5q24/wN5j1wAoQ2/kdGeNoHuluhGb/v9lo+dt7zgiIqKezujdFYrKKlFUVgmn4UOE98qk1UbNETrDB97uzjqDo6oq21Z198eCy1j0SkCbQVDXWrauCcfvp7gLr1XXV1VcF4UHCMdUoV692txyLafSVuOzg3nCuO/PluEvHx7UuI63u7NwXBXAVf+joKIaByjD7d6kaGTuWGrWKvTx/BvY8KY3gpdqryq/s60Ic/ydhPNOpc2Ej6fy3/PmvSV4Z1sRAGBP0jTM9LOH25yjwtisT5SfUdc4QNmOcGLP84/X9fMNYU26xi18yQ0fv+MrvFavoDaenovNe0uEqrT6nLroGqdrnaoQbs6Qqy73/E2MdR6AZ8bZ4kp1I+bPGgFH2ycAAD8W30bueeX/gAT72WOM4wDs+OqqMPaVACcAwBd517WOAwCpVAqxWKx1DYGBgcLvsbGxwrmBgYFISEjAxo0bAQChoaFYuXKlSXMSERF1BKNDrre7M7zdnfFF9lkUlVXicE4h9iZFG9Ua4OI4RKMKa6zElKxWLRT61rJ1TTjshgzSGqwXhQcIx7auCUf47CkoKsvC/LX7AEAjlKoL8HUXxp1KW43QGT5CYNXWrrBmQZDO1oz5a/dh3ZJgnEpbbbYKcsza02g8PVfveefL7mCiuzJoqiq8p9JmtjmXemV45jP2mBHznc5xALB9rW+rAKuibdyzPsPw8Tu+eOsDCXb9s1wIoLn5N4QWjDn+Tug/7VCrcKqPahygDL0LX3LDrn+W61xnZ6i6/UAIqKoK7/xZIzTOycq/gVUvj8Yoh/5CxXeM0wCk51bqHAcAYrEYycnJ8PVV/o+DegCNiopCamoqXF1dhdeTJk0Szs3OzkZOTo4QalUhtz1zEhERdRSDQ656yFNvCUhMyUJiShYWRwTgVNpqs/XBHjlRqLPt4PuzZVi3JFjoDda3lt9PcRcCa1s+O/g4cBrTKvDh7mzh96KySrg4DtFxtlLp1WosCg/AhLHOWq+VmJIFya9SnEpbbbYWjOM/38CepGkm95ACykrq0lfH4qfC0/hguTeO/3yjzV7els6X3UH8fE9MmzDMoGorAITOdEFhyR0h0P5UeBPHf76B6X72wnvLkiTCMQBttma0RTUOULZujHlyULvXqU/L3ttfrtxFVv4Nk+b85cpdTHQbjCvVjZg+cRguXW9os5dXnUQigYuLixBGWx6TyWStqqxVVVXC73FxcQAgBFapVIobN26YNCcREZG5Gd2Tq82nGcrKZOaOpVgcEaDzZitZ1R2NG87a47Mv8rBp5Usmr6UrtAzjRWWVrQL4uiXBCAv0MWsv8IYdRTiw+Rmd50x0H4LzZfpvsPsk7aIw1xx/J6SkXzRoDTFrTyNmrTIYN56eq9ET3J10xDpzz9/UaBnQxdH2CVTdfqD3vPPld/Hnpx0AAGOdB+DcxTqT1ggALi4u2L9/v8nzGDLn2t2SNs4mIiIyndm3EHO0s4GsSndIOnKiEFW1dVpbAABlT+6ptNVYHBHQ5vGiskrcuHlP6/GWaykqq8SiV7SfaypVn/H3Z8o03lfvXW7p04w8zF+7r1Xg35sUjecmjzY64KoCmbbtt34qvImqmw/wwXLvNo/vSZoGH88hBlV6VXMtfMkNjsOeaLVzgz7vbCvCjJjvhB5cXY4cl8HHcwie9RkGQFmlnfmMPXINrILq+14AZc+vj+cQHDkua/c6zSXYzx6Otk8YVOW9Ut2Ie/eb4TvGBoOs+0BySX/Itbe3h0wmE7b3io+PF475+vpCJpMhOztb2/BOm5OIiMgUJj3Wd3FEgMbNWoDyz/6G/Gk95M1PkLljqUZvrSFbiKn7IvssXgmagk8z8vSuZf7afa2uZ0iIzNyxFI52NgAe30Sm3j6gHtRbVru/yD6L9UuVFVngcZuH+pyqdapsXROO2jv3dLZWmCIl/SKWRI4Vek19PIcIvbrXbzRq7Gyg2iZLdV78fE+hL1Y118fvKHtX1ekap34MgMZYXeM27y3R6LXdvLfE6GDdFvU51XeVMGadr/7R1eT+XUfbJ7Dq5dEAgHuNzRo7Irz5pycxqH8f4bznvGzxzdkaIdCeu1iH2VOG48fi2xpzahvn6uqqceNXQkICKioqhHGpqakQi8XCzWUAkJOTo3P9HTEnERGRKUQAFCKPeV29jnbL3LEUKenfm33bMEOcSlutt42jOyo/Ogfvp1wwS0jsyRpPz9W6L7Alk5ekaz12+rTp/drG6Kyt+YiIqHdRlB4wrZLbHZhzm63eQn3rLyIiIiJL1OMe60tEREREpE+Pr+R2Jf6ptWfr7k9WIyIiovbTG3JbPnSB9GP4pe7MyjOyq5dARETU4diuQEREREQWhyGXiIiIiCyOWUKuVCpFYGAgUlNTO2RcYGCgsMm8uXTEnMbwdnfGqbTVWLckuFPGEREREfUmentys7OzNTZwB5Qbu6ueW6/O0dGxXYto77juqq0HU2jbT/d6jf5H6LalveOIiIiIegODdlfw8/PD5s2bAShDr1gs1gi6rq6u7Xp6UXvH9QRFZZXCU8sWRwRgb1K0RtAtKqts1w1q7R1HRERE1JsY3a4QFBQEPz8/pKcrn5oUHx+PwMBABAYGajybPjU1FVFRURpjt2zZgi1btugcBzxuY1D9tKR+TL3VQTWX6pjqWqbMaQ6fZuShqKwSi15RVnf3JkXjVNpqnEpbjcURjyu+65YEI3PHUo2xW9eEY+uacJ3jgMdtDKof1RgV9WPqrQ6n0lbD2925zdd7k6KxOCJAY6z6uURERETdVbv2yfX19YVEIgEAocIbHx+vcY5YLMbOnTshlUqFiu+RI0eEAKltnGpscnIyfH19AUAjlEZFRWlUkaOiojBp0iTh3OzsbOTk5EAqlUIsFmPlypUmz2kOpVer4fGkAwAIFd69SdEa5ySmZAlBUlXx/f0Ud+F8beMAYM2CIHx2MA+fZuS1Opa5Y6lGFTlzx1KEzvAx6FHIi8IDhMrx1jXhCJ89BUVlWQZ9ZiIiIqKu0qEPg4iNjUVOTg7EYjGys7MRGhraZi+vOolEAhcXlzYDpkQigUwmg1gs1ni/qqpK+D0uLg4AhOtIpVLcuHHDpDk70+GcQiFILo4IwPdny9rs5W2p9Go1FoUHYMJYZ/zlw4PC+6EzfOBoZ9MqGLs4DjFoPZ8dfBya1eclIiIi6s7aFXIlEolBVc7AwECsWrVKCLktg2R7uLi4YP/+/SbP09FztuTxpANKr1brPe/gN2exaeVLAIAAX3d8kX3WoPkTU7KQmJIltBeo9wRX1dYh5M1P2r94IiIioh7G6J7c1NRU5OfnGxRYXV1dMXLkSEgkElRUVBgUjO3t7SGTyYTtvdTbGXx9fSGTyVr18HbFnMZYtyQY3u7OSEzR/2f+orJK3Lh5D6EzfGA/bJBBLQXqPs3Iw/y1+4Te2SMnCuFoZ9Oqh1edu6uyjaJlHy8RERFRT2VQJTc/P1/oYXVxcdHYESEqKgoymUw4b+PGjRq9r2KxGHFxcUhISNCYU9e42NhYIUQnJCSgoqJCGJeamgqxWKyxrZm+HRpcXV3NPqc+qhvBAGUlVX1HhMwdS+FoZyOctyg8AO9/kiUE2i+yz2L90mCNVgF949SPAZptBvPX7sPepGiNbc1U6zmcU4j1S4OxfmkwDucUoqq2zqTPTURERNQdiAAoRB7ztJ6gCmpkOG7xRURERNR1FKUH+FhfIiIiIrI8DLlEREREZHEYcomIiIjI4ujtySUiIiIi6knYk0tEREREFokhl4iIiIgsDkMuEREREVkchlwiIiIisjgMuURERERkcRhyiYiIiMjiMOQSERERkcVhyCUiIiIii8OQS0REREQWhyGXiIiIiCwOQy4RERERWRyGXCIiIiKyOAy5RERERGRxGHKJiIiIyOIw5BIRERGRxWHIJSIiIiKLw5BLRERERBaHIZeIiIiILE4fABtEdhP1nhj6j8XwfysUvlGBsOrbB7KCS22eF3N4AyrOlKK+5k67F6VrDkPX0dK4oKkI3fp/4RsVCN+oQEj257R7feocvFwx77//E4Mch+LqTxfMPs4c32dnzElERETUbdSeR19jzj+5/TB+yz7TUcsxyJH//BSAMuwa47fsM/gt+wwcvFwRsinWoDFTX5+FyRHTNd7LXLUT1cXSVuc21NYZtR5TxxERERGRdkaF3N6opvSaEKynvj4LIZtiNYJudbEUe8I2GD1ve8cRERERkX4mh1xdldFxQVPhvyxMeF1yTIK8j74EoPyTuXpYbPl63B/9hHmlp0vx7XupBq0n5vCGNq9nDmc+P4aRU9zx1KuB+Pa9VIT+YzGGe4wAABRk5OLM58cAAAErXsTIKe44ELNFGPvCu2IA0DkO0P196vp8MYc3oCAjV6g8q39n7Z2TiIiIqKcyOeSGbIrVaGNQBSYHL1f4LwsTjqmCVvWvVwxqebBzcxQqnTGHN2Bc0FS94+btWakRlOftWWnQOGPUllfBzs0RgPbWibyPvkTM4Q1w8HIV1uI6zQOZq3bqHAdo/z4N+Xwjp7hjT9iGVqHWlDmJiIiIeiKTQu64oKmor61rMxA9+YwXakqvCceqi6WQni6Fw4RRBgWoH//fV8LvNaXXMNhpmN61DLSzaVWx1Deuo5Qck2DcH/1QXSzF1NdnQXq6tM1eXnW6vk9DPp/qO1Ndx8HLFcPcHE2ak4iIiKgnsqie3PraOo0WgY5g5+aI2vIqvef99nU+Zr4dCUBZYS3+Ot/ka3fE5+uM74yIiIios5m0T+7N8ioMtLOBg5crAM0/v1/9uRjDPUYIxxy8XOE6zQPVv14Rzhn26M/+qn7VtowLmorhHiNw9edinWv5LfsMBtrZYOrrs9r9efQJWPEihnuMMKhntbpYiobaOowLmooBdjYGVa91fZ/t/XwdMScRERFRd2dSJbe6WIqSYxLhz90FGbkYYGcjHCvIyNX4U3hBRq4Q9kqOSeC/LAz+y8JQckyC+hZbaamPa9kzOvDRNYZ7jMDkiOlCv2nmqp0I2RSrse2XqTsYDPcYIfSw1tfWacynay0AUPx1PvyXhaEgI1djTl3jtH2fqu/B2M+n699Re+ckIiIi6u5EABQij3l6Twz9x2IUf53f429IUt2UxSBHREREZJkUpQf4WF8iIiIisjxGtSuo2gta7u3aE7Tcs5eIiIiILJfB7QpERERERD0B2xWIiIiIyCIx5BIRERGRxWHIJSIiIiKLw5BLRERERBaHIZeIiIiILA5DLhERERFZHIZcIiIiIrI4DLlEREREZHEYcomIiIjI4jDkEhEREZHFYcglIiIiIovDkEtEREREFochl4iIiIgsDkMuEREREVkchlwiIiIisjgMuURERERkcRhyiYiIiMjiMOQSERERkcVhyCUiIiIii8OQS0REREQWhyGXiIiIiCwOQy4RERERWRwRAEVXL4KIiIiIyJz+F6J/XHUFxAKbAAAAAElFTkSuQmCC" width="697" height="135" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="fonctions">Fonctions<a href="#fonctions" class="hash-link" aria-label="Lien direct vers Fonctions" title="Lien direct vers Fonctions">​</a></h2><p>Une fonction PowerShell est un bloc de script qu&#x27;on enregistre dans la session en cours. On doit la déclarer en lui donnant un nom, et à l&#x27;instar d&#x27;un fichier de script, elle se comporte exactement comme un script ou une commande.</p><p>Pour déclarer une fonction, on utilise le mot-clé <code>function</code> suivi de son nom, et on définit le code de la fonction entre des accolades. Il est recommandé d&#x27;indenter le contenu de la fonction.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Get-Zero</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>attention</div><div class="admonitionContent_S0QG"><p>La déclaration d&#x27;une fonction n&#x27;a d&#x27;effet que dans la session en cours. Après l&#x27;exécution du script ou après fermeture de la fenêtre PowerShell, celle-ci n&#x27;existe plus et il faudra la déclarer à nouveau si on veut l&#x27;utiliser.</p></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>astuce</div><div class="admonitionContent_S0QG"><p>On peut obtenir la liste de toutes les fonctions qui sont déclarées dans la session PowerShell en cours à l&#x27;aide de la commande <code>Get-ChildItem Function:</code>.</p><p><img loading="lazy" alt="image" src="/3A5-Automatisation/assets/images/r06_01g-0e4408b15ea27c39407b0c8e2ae324b7.png" width="697" height="178" class="img_ev3q"></p></div></div><p>L&#x27;exemple ci-dessus montre la fonction déclarée sous le nom de <code>Get-Zero</code>, et qui sert simplement à obtenir la valeur 0. Celle-ci ne fait qu&#x27;envoyer l&#x27;objet <code>0</code> (un nombre entier) dans le pipeline, afin que cette valeur soit récupérée à la sortie de la fonction.</p><p><img loading="lazy" alt="image" src="/3A5-Automatisation/assets/images/r06_01f-7480aa949836dfbd5d46d64b512ce148.png" width="697" height="210" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sortie-dans-le-pipeline">Sortie dans le pipeline<a href="#sortie-dans-le-pipeline" class="hash-link" aria-label="Lien direct vers Sortie dans le pipeline" title="Lien direct vers Sortie dans le pipeline">​</a></h3><p>Une fonction (tout comme un script, d&#x27;ailleurs), dispose en quelque sorte d&#x27;un &quot;accumulateur&quot; qui contient tous les objets qui tombent dans le pipeline. À la sortie de la fonction, les objets sortent sous forme de collection.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">function Get-CrisDAnimaux {</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;Miaou!&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;Wouf!&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &quot;Cocorico!&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Cette fonction laisse tomber trois objets <code>String</code> dans le pipeline. Ceux-ci sortent sous forme de collection. C&#x27;est la même chose avec un fichier PS1.</p><p><img loading="lazy" alt="image" src="data:image/png;base64,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" width="697" height="137" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="instruction-return">Instruction <em>Return</em><a href="#instruction-return" class="hash-link" aria-label="Lien direct vers instruction-return" title="Lien direct vers instruction-return">​</a></h3><p>L&#x27;instruction <code>return</code> permet de sortir un objet sur le pipeline tout en interrompant immédiatement l&#x27;exécution de la fonction. </p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Get-Zero</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> 0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Ce texte ne sera jamais écrit!&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>Dans un script, on utilise souvent une fonction lorsque du code se répète souvent, pour éviter de copier-coller le même code à plusieurs endroits dans le script. Une fonction doit obligatoirement être définie avant d&#x27;être appelée, mais il est une bonne pratique de déclarer toutes les fonctions au début du script, juste après le bloc de paramètres, mais avant le code principal du script.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="validation-des-paramètres">Validation des paramètres<a href="#validation-des-paramètres" class="hash-link" aria-label="Lien direct vers Validation des paramètres" title="Lien direct vers Validation des paramètres">​</a></h2><p>Une fonction et un script <code>.PS1</code> se comportent comme une commande PowerShell. L&#x27;un est enregistré dans la session en cours, l&#x27;autre est défini sous forme de fichier. Mais dans les deux cas, on peut leur définir des paramètres au moyen d&#x27;un bloc <code>param()</code>.</p><p>Par exemple, le script <code>Division.ps1</code> vu précédemment aurait pu, à la place, être défini comme une fonction.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> Division </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">param</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token namespace">[double]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Dividende</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token namespace">[double]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Diviseur</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token variable" style="color:rgb(9, 134, 88)">$Dividende</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Diviseur</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Lorsqu&#x27;on déclare des paramètres, il y a le risque que celui-ci soit mal utilisé. Par exemple, qu&#x27;arrive-t-il si on appelle la fonction de division pour diviser &quot;Chat&quot; par trois? Qu&#x27;arrive-t-il si on demande de diviser un nombre par zéro?</p><p>Et surtout, qu&#x27;arrive-t-il si, dans un script assez long et qui effectue plusieurs tâches, un paramètre non conforme fait planter le script à mi-chemin de son exécution?</p><p>PowerShell nous offre diverses méthodes pour valider les paramètres à la source, afin de s&#x27;assurer que toutes les valeurs sont conformes à ce qui est attendu avant de commencer son exécution.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="validation-de-type">Validation de type<a href="#validation-de-type" class="hash-link" aria-label="Lien direct vers Validation de type" title="Lien direct vers Validation de type">​</a></h3><p>Lorsqu&#x27;on spécifie un type à un paramètre, le script valide d&#x27;abord si la valeur correspond au type attendu.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">param</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[double]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Dividende</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[double]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Diviseur</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$Dividende</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Diviseur</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Si la valeur attendue ne correspond pas au type du paramètre, le script plante (et c&#x27;est ce qu&#x27;on veut; mieux vaut un script qui plante qu&#x27;un script qui fait n&#x27;importe quoi).</p><p><img loading="lazy" alt="image" src="/3A5-Automatisation/assets/images/r06_01i-fcab9ec3ea240632edd82502ed59bbd7.png" width="697" height="264" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="critères-de-validation">Critères de validation<a href="#critères-de-validation" class="hash-link" aria-label="Lien direct vers Critères de validation" title="Lien direct vers Critères de validation">​</a></h3><p>PowerShell offre, en plus de la validation de type, différents critères de validation pour identifier au maximum les risques de valeurs illégales spécifiées en paramètre.</p><p>Par exemple, si on souhaite éviter que la fonction ou le script puisse être appelé avec un diviseur égal à zéro, on peut ajouter un critère de validation dans la déclaration du paramètre. Dans l&#x27;exemple suivant, on définit un script qui, s&#x27;il est évalué <code>False</code>, refusera d&#x27;exécuter le code.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">param</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[double]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Dividende</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[ValidateScript( { $_ -ne 0 } )]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[double]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Diviseur</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$Dividende</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Diviseur</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>On peut clairement voir, à l&#x27;analyse du message d&#x27;erreur, que le script ou la fonction a planté en raison d&#x27;un échec de validation du paramètre <code>Diviseur</code>.</p><p><img loading="lazy" alt="image" src="/3A5-Automatisation/assets/images/r06_01j-2757c0ac97744e9eb06229fd50f30b1b.png" width="697" height="264" class="img_ev3q"></p><p>Il existe plusieurs types de validation de paramètre. En voici quelques exemples:</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="validateset">ValidateSet<a href="#validateset" class="hash-link" aria-label="Lien direct vers ValidateSet" title="Lien direct vers ValidateSet">​</a></h4><p>La clause <code>ValidateSet</code> permet de s&#x27;assurer que la valeur passée en paramètre fait partie d&#x27;une liste de valeurs admissibles.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">param</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">ValidateSet</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Rouge&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Vert&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">&#x27;Bleu’</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[string]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Couleur</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># Accepte seulement les chaînes de caractères &quot;Rouge&quot;, &quot;Vert&quot; ou &quot;Bleu&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>astuce</div><div class="admonitionContent_S0QG"><p>Lorsqu&#x27;on utilise la clause <code>ValidateSet</code>, cela permet à PowerShell d&#x27;énumérer les valeurs admissibles lors de l&#x27;appel de la fonction ou du script, au moyen de la touche de tabulation ou de <code>Ctrl+Espace</code>.</p><p><img loading="lazy" alt="image" src="data:image/png;base64,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" width="697" height="104" class="img_ev3q"></p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="validaterange">ValidateRange<a href="#validaterange" class="hash-link" aria-label="Lien direct vers ValidateRange" title="Lien direct vers ValidateRange">​</a></h4><p>La clause <code>ValidateRange</code> permet de s&#x27;assurer qu&#x27;un nombre passé en paramètre est situé entre deux valeurs inclusivement.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">param</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[ValidateRange(7,120)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[Int]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Age</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># Accepte un nombre entier de 7 à 120 incl.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>astuce</div><div class="admonitionContent_S0QG"><p><code>ValidateRange</code> exige de spécifier les valeurs minimum et maximum. Mais lorsqu&#x27;on souhaite seulement spécifier une valeur maximum ou minimum, on peut faire appel aux propriétés MaxValue et MinValue du type en question.</p><p>Par exemple, pour attendre un nombre de type <code>[int]</code> de 7 ou plus, il suffit de spécifier un <em>range</em> de 7 à la valeur maximale du type <code>[int]</code>, soit <code>[int]::MaxValue</code>.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">param</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[ValidateRange(7, [int]::MaxValue)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[Int]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Age</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># Accepte un nombre entier de 7 ou plus.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="validatelength">ValidateLength<a href="#validatelength" class="hash-link" aria-label="Lien direct vers ValidateLength" title="Lien direct vers ValidateLength">​</a></h4><p>La clause <code>ValidateLength</code> valide la taille minimum et maximum d&#x27;une chaîne de caractères.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">param</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[ValidateLength(0,15)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[String]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$NoTel</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># Accepte une chaîne de 0 à 15 caractères incl.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="validatecount">ValidateCount<a href="#validatecount" class="hash-link" aria-label="Lien direct vers ValidateCount" title="Lien direct vers ValidateCount">​</a></h4><p>La clause <code>ValidateCount</code> valide le nombre d&#x27;éléments minimum et maximum d&#x27;une collection d&#x27;objets passée en paramètre.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">param</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[ValidateCount(1,5)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[String[]]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$ComputerName</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># Accepte un tableau de 1 à 5 éléments incl.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="validatescript">ValidateScript<a href="#validatescript" class="hash-link" aria-label="Lien direct vers ValidateScript" title="Lien direct vers ValidateScript">​</a></h4><p>La clause <code>ValidateScript</code> est la plus versatile et peut être utilisée pour les validations plus complexes qui ne peuvent être faites par les autres méthodes. Elle permet de spécifier un script à exécuter avec la valeur passée en paramètre (représentée par la variable pipeline <code>$_</code>). Si le script retourne <code>True</code>, l&#x27;argument est validé; s&#x27;il retourne <code>False</code>, la validation échoue et le script plante.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">param</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[ValidateScript( { Test-Path $_ } )]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[String]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Path</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># Permet de créer un script qui retourne vrai ou faux. Si faux, le paramètre est rejeté.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="paramètres-obligatoires">Paramètres obligatoires<a href="#paramètres-obligatoires" class="hash-link" aria-label="Lien direct vers Paramètres obligatoires" title="Lien direct vers Paramètres obligatoires">​</a></h3><p>Par défaut, tous les paramètres sont optionnels. S&#x27;ils ne sont pas spécifiés lors de l&#x27;appel de la fonction ou du script, alors ils prennent automatiquement leur valeur neutre.</p><ul><li>La valeur 0 pour les types numériques (<code>int</code>, <code>double</code>...)</li><li>Une chaîne vide (<code>&quot;&quot;</code>) pour le type <code>string</code></li><li>Une valeur nulle (<code>$null</code>) pour les collections</li><li>etc.</li></ul><p>Pour s&#x27;assurer qu&#x27;un paramètre soit spécifié à l&#x27;appel de la fonction ou du script, on peut ajouter un bloc <code>[Parameter()]</code> à la déclaration du paramètre. Ce bloc permet de définir certaines propriétés du paramètre. Pour rendre le paramètre obligatoire, il faut activer la propriété Mandatory du paramètre.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> Soustraction </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">param</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token namespace">[Parameter(Mandatory)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token namespace">[double]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$op1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token namespace">[Parameter(Mandatory)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token namespace">[double]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$op2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token variable" style="color:rgb(9, 134, 88)">$op1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$op2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Si un paramètre obligatoire n&#x27;est pas spécifié, le script refusera de s&#x27;exécuter. À la place, il demandera à l&#x27;utilisateur de spécifier les paramètres manquants à la ligne de commande. L&#x27;appelant peut alors soit saisir manuellement l&#x27;argument manquant, soit annuler l&#x27;exécution du script avec les touches <code>Ctrl+C</code>.</p><p><img loading="lazy" alt="image" src="/3A5-Automatisation/assets/images/r06_01l-70cc05c98fc1accaf84e616279cf0b3f.png" width="697" height="175" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="valeur-par-défaut-dun-paramètre">Valeur par défaut d&#x27;un paramètre<a href="#valeur-par-défaut-dun-paramètre" class="hash-link" aria-label="Lien direct vers Valeur par défaut d&#x27;un paramètre" title="Lien direct vers Valeur par défaut d&#x27;un paramètre">​</a></h3><p>Une alternative à rendre obligatoire un paramètre consiste à lui attribuer une valeur par défaut. Ainsi, ce paramètre prendra automatiquement la valeur spécifiée si l&#x27;utilisateur ne le spécifie pas à l&#x27;appel du script ou de la fonction.</p><p>Par exemple, voici le script <code>Arrondir.ps1</code>.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">Param</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[Parameter(Mandatory)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[double]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Nombre</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[int]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Decimales</span><span class="token plain"> = 2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token namespace">[Math]</span><span class="token plain">::Round</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token variable" style="color:rgb(9, 134, 88)">$Nombre</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Decimales</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>La valeur du paramètre <code>Decimales</code> prend la valeur 2 à moins d&#x27;être spécifiée explicitement.</p><p><img loading="lazy" alt="image" src="/3A5-Automatisation/assets/images/r06_01m-d3c87f9cbf6510c2d2a209265ec699dd.png" width="697" height="137" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="paramètres-de-type-switch">Paramètres de type Switch<a href="#paramètres-de-type-switch" class="hash-link" aria-label="Lien direct vers Paramètres de type Switch" title="Lien direct vers Paramètres de type Switch">​</a></h3><p>Les paramètres de type Switch prennent une valeur booléenne (vraie ou fausse) selon qu&#x27;ils soient spécifiés ou non. On les identifie avec le type <!-- -->[switch]<!-- -->.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">param</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[Parameter(Mandatory)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[double]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$op1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[Parameter(Mandatory)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[double]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$op2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[switch]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Miauler</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$op1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$op2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token variable" style="color:rgb(9, 134, 88)">$Miauler</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Miaou!&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="paramètres-de-type-collection">Paramètres de type collection<a href="#paramètres-de-type-collection" class="hash-link" aria-label="Lien direct vers Paramètres de type collection" title="Lien direct vers Paramètres de type collection">​</a></h3><p>Il est possible de faire en sorte qu&#x27;un paramètre admette plus d&#x27;une valeur. Il suffit de faire de son type une collection. Si par exemple, on souhaite que le paramètre permette de passer une ou plusieurs valeurs entières, on va donner au paramètre le type <code>[int[]]</code>, soit un tableau d&#x27;entier.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">param</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[int[]]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Nombres</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$total</span><span class="token plain"> = 0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token variable" style="color:rgb(9, 134, 88)">$nombre</span><span class="token plain"> in </span><span class="token variable" style="color:rgb(9, 134, 88)">$Nombres</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token variable" style="color:rgb(9, 134, 88)">$total</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">+=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$nombre</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># On renvoie le total dans le pipeline!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token variable" style="color:rgb(9, 134, 88)">$total</span><span class="token plain">    </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>astuce</div><div class="admonitionContent_S0QG"><p>Les paramètres qui admettent un tableau de valeurs se combinent très bien avec la clause de validation <code>[ValidateCount()]</code>, pour spécifier un nombre minimum et maximum d&#x27;éléments dans le tableau.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="entrée-par-le-pipeline">Entrée par le pipeline<a href="#entrée-par-le-pipeline" class="hash-link" aria-label="Lien direct vers Entrée par le pipeline" title="Lien direct vers Entrée par le pipeline">​</a></h3><p>On peut permettre à une fonction ou un script de traiter l&#x27;entrée du pipeline.</p><p>Par exemple, le script Saluer.ps1 accepte deux paramètres, un nom et un titre. Mais lorsqu&#x27;une valeur admissible entre par le pipeline, celle-ci entrera dans le paramètre Nom.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">Param</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[Parameter(Mandatory, ValueFromPipeline)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[string]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Nom</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">ValidateSet</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;M.&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Mme.&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Mlle.&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Dr.&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Me.&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">[string]</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$Titre</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Bonjour, </span><span class="token string variable" style="color:rgb(9, 134, 88)">$Titre</span><span class="token string" style="color:rgb(163, 21, 21)"> </span><span class="token string variable" style="color:rgb(9, 134, 88)">$Nom</span><span class="token string" style="color:rgb(163, 21, 21)">!&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>De cette manière, le paramètre Nom peut soit être spécifié par le paramètre, soit par l&#x27;entrée du pipeline. Dans les deux cas, l&#x27;effet est le même.</p><p><img loading="lazy" alt="image" src="/3A5-Automatisation/assets/images/r06_01n-2f6cb81331d1b561ecacad85ca8f4f13.png" width="697" height="144" class="img_ev3q"></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Pages de documentation"><a class="pagination-nav__link pagination-nav__link--prev" href="/3A5-Automatisation/cours/r05"><div class="pagination-nav__sublabel">Précédent</div><div class="pagination-nav__label">Rencontre 5 - Scripts PowerShell</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/3A5-Automatisation/cours/r07"><div class="pagination-nav__sublabel">Suivant</div><div class="pagination-nav__label">Rencontre 7 - Fichiers, strings, regex</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#les-scripts-et-le-pipeline" class="table-of-contents__link toc-highlight">Les scripts et le pipeline</a></li><li><a href="#paramètres-dun-script" class="table-of-contents__link toc-highlight">Paramètres d&#39;un script</a></li><li><a href="#fonctions" class="table-of-contents__link toc-highlight">Fonctions</a><ul><li><a href="#sortie-dans-le-pipeline" class="table-of-contents__link toc-highlight">Sortie dans le pipeline</a></li><li><a href="#instruction-return" class="table-of-contents__link toc-highlight">Instruction <em>Return</em></a></li></ul></li><li><a href="#validation-des-paramètres" class="table-of-contents__link toc-highlight">Validation des paramètres</a><ul><li><a href="#validation-de-type" class="table-of-contents__link toc-highlight">Validation de type</a></li><li><a href="#critères-de-validation" class="table-of-contents__link toc-highlight">Critères de validation</a></li><li><a href="#paramètres-obligatoires" class="table-of-contents__link toc-highlight">Paramètres obligatoires</a></li><li><a href="#valeur-par-défaut-dun-paramètre" class="table-of-contents__link toc-highlight">Valeur par défaut d&#39;un paramètre</a></li><li><a href="#paramètres-de-type-switch" class="table-of-contents__link toc-highlight">Paramètres de type Switch</a></li><li><a href="#paramètres-de-type-collection" class="table-of-contents__link toc-highlight">Paramètres de type collection</a></li><li><a href="#entrée-par-le-pipeline" class="table-of-contents__link toc-highlight">Entrée par le pipeline</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Sources</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/departement-info-cem/3A5-Automatisation" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Vincent Carrier. Tous droits réservés.</div></div></div></footer></div>
<script src="/3A5-Automatisation/assets/js/runtime~main.1edb1c17.js"></script>
<script src="/3A5-Automatisation/assets/js/main.9a7af7e9.js"></script>
</body>
</html>
"use strict";(self.webpackChunkdepinfo_template=self.webpackChunkdepinfo_template||[]).push([[997],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>b});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var u=n.createContext({}),i=function(e){var t=n.useContext(u),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},p=function(e){var t=i(e.components);return n.createElement(u.Provider,{value:t},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,u=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=i(a),d=r,b=c["".concat(u,".").concat(d)]||c[d]||m[d]||l;return a?n.createElement(b,o(o({ref:t},p),{},{components:a})):n.createElement(b,o({ref:t},p))}));function b(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,o=new Array(l);o[0]=d;var s={};for(var u in t)hasOwnProperty.call(t,u)&&(s[u]=t[u]);s.originalType=e,s[c]="string"==typeof e?e:r,o[1]=s;for(var i=2;i<l;i++)o[i]=a[i];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},5162:(e,t,a)=>{a.d(t,{Z:()=>o});var n=a(7294),r=a(6010);const l={tabItem:"tabItem_Ymn6"};function o(e){let{children:t,hidden:a,className:o}=e;return n.createElement("div",{role:"tabpanel",className:(0,r.Z)(l.tabItem,o),hidden:a},t)}},4866:(e,t,a)=>{a.d(t,{Z:()=>N});var n=a(7462),r=a(7294),l=a(6010),o=a(2466),s=a(6550),u=a(1980),i=a(7392),p=a(12);function c(e){return function(e){return r.Children.map(e,(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:a,attributes:n,default:r}}=e;return{value:t,label:a,attributes:n,default:r}}))}function m(e){const{values:t,children:a}=e;return(0,r.useMemo)((()=>{const e=t??c(a);return function(e){const t=(0,i.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,a])}function d(e){let{value:t,tabValues:a}=e;return a.some((e=>e.value===t))}function b(e){let{queryString:t=!1,groupId:a}=e;const n=(0,s.k6)(),l=function(e){let{queryString:t=!1,groupId:a}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:t,groupId:a});return[(0,u._X)(l),(0,r.useCallback)((e=>{if(!l)return;const t=new URLSearchParams(n.location.search);t.set(l,e),n.replace({...n.location,search:t.toString()})}),[l,n])]}function k(e){const{defaultValue:t,queryString:a=!1,groupId:n}=e,l=m(e),[o,s]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!d({value:t,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const n=a.find((e=>e.default))??a[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:l}))),[u,i]=b({queryString:a,groupId:n}),[c,k]=function(e){let{groupId:t}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(t),[n,l]=(0,p.Nk)(a);return[n,(0,r.useCallback)((e=>{a&&l.set(e)}),[a,l])]}({groupId:n}),f=(()=>{const e=u??c;return d({value:e,tabValues:l})?e:null})();(0,r.useLayoutEffect)((()=>{f&&s(f)}),[f]);return{selectedValue:o,selectValue:(0,r.useCallback)((e=>{if(!d({value:e,tabValues:l}))throw new Error(`Can't select invalid tab value=${e}`);s(e),i(e),k(e)}),[i,k,l]),tabValues:l}}var f=a(2389);const h={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function v(e){let{className:t,block:a,selectedValue:s,selectValue:u,tabValues:i}=e;const p=[],{blockElementScrollPositionUntilNextRender:c}=(0,o.o5)(),m=e=>{const t=e.currentTarget,a=p.indexOf(t),n=i[a].value;n!==s&&(c(t),u(n))},d=e=>{let t=null;switch(e.key){case"Enter":m(e);break;case"ArrowRight":{const a=p.indexOf(e.currentTarget)+1;t=p[a]??p[0];break}case"ArrowLeft":{const a=p.indexOf(e.currentTarget)-1;t=p[a]??p[p.length-1];break}}t?.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":a},t)},i.map((e=>{let{value:t,label:a,attributes:o}=e;return r.createElement("li",(0,n.Z)({role:"tab",tabIndex:s===t?0:-1,"aria-selected":s===t,key:t,ref:e=>p.push(e),onKeyDown:d,onClick:m},o,{className:(0,l.Z)("tabs__item",h.tabItem,o?.className,{"tabs__item--active":s===t})}),a??t)})))}function y(e){let{lazy:t,children:a,selectedValue:n}=e;const l=(Array.isArray(a)?a:[a]).filter(Boolean);if(t){const e=l.find((e=>e.props.value===n));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},l.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==n}))))}function g(e){const t=k(e);return r.createElement("div",{className:(0,l.Z)("tabs-container",h.tabList)},r.createElement(v,(0,n.Z)({},e,t)),r.createElement(y,(0,n.Z)({},e,t)))}function N(e){const t=(0,f.Z)();return r.createElement(g,(0,n.Z)({key:String(t)},e))}},334:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>u,default:()=>f,frontMatter:()=>s,metadata:()=>i,toc:()=>c});var n=a(7462),r=(a(7294),a(3905)),l=a(4866),o=a(5162);const s={},u="Rencontre 4 - Dictionnaires",i={unversionedId:"cours/r04",id:"cours/r04",title:"Rencontre 4 - Dictionnaires",description:"1. Rappel du cours pr\xe9c\xe9dent",source:"@site/docs/cours/r04.md",sourceDirName:"cours",slug:"/cours/r04",permalink:"/3A5-Automatisation/cours/r04",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Rencontre 3 - Collections et types",permalink:"/3A5-Automatisation/cours/r03"}},p={},c=[{value:"Tables de hachage (<em>HashTable</em>)",id:"tables-de-hachage-hashtable",level:2},{value:"Dictionnaires tri\xe9s",id:"dictionnaires-tri\xe9s",level:3},{value:"Comportement du <em>HashTable</em>",id:"comportement-du-hashtable",level:3},{value:"Objets personnalis\xe9s (<em>PSCustomObject</em>)",id:"objets-personnalis\xe9s-pscustomobject",level:2},{value:"Collections de <em>PSCustomObject</em>",id:"collections-de-pscustomobject",level:3},{value:"Modifier une propri\xe9t\xe9",id:"modifier-une-propri\xe9t\xe9",level:3},{value:"Ajouter des propri\xe9t\xe9s",id:"ajouter-des-propri\xe9t\xe9s",level:3},{value:"Ajouter des m\xe9thodes",id:"ajouter-des-m\xe9thodes",level:3},{value:"Splatting",id:"splatting",level:2}],m=(d="PowerShellWindow",function(e){return console.warn("Component "+d+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",e)});var d;const b={toc:c},k="wrapper";function f(e){let{components:t,...a}=e;return(0,r.kt)(k,(0,n.Z)({},b,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"rencontre-4---dictionnaires"},"Rencontre 4 - Dictionnaires"),(0,r.kt)("admonition",{title:"R\xe9sum\xe9 de la s\xe9ance",type:"note"},(0,r.kt)(l.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"deroulement",label:"\ud83d\udc68\u200d\ud83c\udfeb D\xe9roulement du cours",mdxType:"TabItem"},(0,r.kt)("ol",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ol"},"Rappel du cours pr\xe9c\xe9dent"),(0,r.kt)("li",{parentName:"ol"},"Hashtable"),(0,r.kt)("li",{parentName:"ol"},"PSCustomObject"),(0,r.kt)("li",{parentName:"ol"},"Splatting"),(0,r.kt)("li",{parentName:"ol"},"Devoir #1 (en \xe9quipe)"))),(0,r.kt)(o.Z,{value:"exercices",label:"\ud83d\udcbb Exercices \xe0 compl\xe9ter",mdxType:"TabItem"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"Devoir #1 (\xe0 remettre au plus tard dimanche le 10 septembre \xe0 23h59)"))),(0,r.kt)(o.Z,{value:"ressources",label:"\ud83d\udcda Ressources \xe0 consulter",mdxType:"TabItem"},(0,r.kt)("p",{parentName:"admonition"},"La pr\xe9sentation PowerPoint est sur le Teams du cours, sous le canal G\xe9n\xe9ral > Fichiers > Supports de cours.")))),(0,r.kt)("p",null,"Un ",(0,r.kt)("strong",{parentName:"p"},"dictionnaire"),", aussi appel\xe9 ",(0,r.kt)("em",{parentName:"p"},"tableau associatif"),", est une structure de donn\xe9es qui se caract\xe9rise par une liste de correspondance entre une cl\xe9 et une valeur, qui repr\xe9sentent des propri\xe9t\xe9s. La cl\xe9 repr\xe9sente le nom de la propri\xe9t\xe9, et la valeur, son contenu. Contrairement aux tableaux, l'ordre des \xe9l\xe9ments n'a pas d'importance, justement parce qu'on peut y acc\xe9der librement en utilisant la cl\xe9."),(0,r.kt)("p",null,"Dans PowerShell, on travaille avec deux types de dictionnaires, des ",(0,r.kt)("em",{parentName:"p"},"HashTable"),", et des ",(0,r.kt)("em",{parentName:"p"},"PSCustomObject"),"."),(0,r.kt)("h2",{id:"tables-de-hachage-hashtable"},"Tables de hachage (",(0,r.kt)("em",{parentName:"h2"},"HashTable"),")"),(0,r.kt)("p",null,"La table de hachage (",(0,r.kt)("em",{parentName:"p"},"HashTable"),") est la forme la plus rudimentaire d'un dictionnaire en PowerShell."),(0,r.kt)("p",null,"Voici un exemple de cr\xe9ation d'un objet de type ",(0,r.kt)("em",{parentName:"p"},"HashTable"),":"),(0,r.kt)(l.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"code",label:"Code",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},'$minou = @{ \n    Nom = "Garfield"\n    Espece = "Felis catus"\n    Passion = "Manger"\n}\n'))),(0,r.kt)(o.Z,{value:"resultat",label:"R\xe9sultat",mdxType:"TabItem"},(0,r.kt)(m,{workdir:"C:\\",command:"$minou",result:"\nName            Value\n----            -----\nPassion         Manger\nNom             Garfield\nEspece          Felis catus",mdxType:"PowerShellWindow"}))),(0,r.kt)("p",null,'Chaque cl\xe9 de cet objet est le nom d\'une de ses propri\xe9t\xe9s. On peut donc acc\xe9der \xe0 une propri\xe9t\xe9 avec la notation ".".'),(0,r.kt)(m,{workdir:"C:\\",command:"$minou.Passion",result:"\nManger\n",mdxType:"PowerShellWindow"}),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Pour cr\xe9er un objet ",(0,r.kt)("em",{parentName:"p"},"hashtable")," en une seule ligne, utilisez le caract\xe8re ; entre les \xe9l\xe9ments."),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},'$minou = @{ Nom = "Garfield" ; Espece = "Felis catus" ; Passion = "Manger" }\n'))),(0,r.kt)("h3",{id:"dictionnaires-tri\xe9s"},"Dictionnaires tri\xe9s"),(0,r.kt)("p",null,"G\xe9n\xe9ralement, on n'a pas besoin qu'un dictionnaire soit tri\xe9, car il sert \xe0 acc\xe9der \xe0 ses propri\xe9t\xe9s \xe0 la demande, et non de mani\xe8re s\xe9quentielle. Mais si, pour une quelconque raison, vous souhaitiez tout de m\xeame pr\xe9server l'ordre des \xe9l\xe9ments du dictionnaire, pour pouvez d\xe9clarer l'attribut ",(0,r.kt)("inlineCode",{parentName:"p"},"[ordered]"),"."),(0,r.kt)(l.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"code",label:"Code",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},'$minou = [ordered]@{ \n    Nom = "Garfield"\n    Espece = "Felis catus"\n    Passion = "Manger"\n}\n'))),(0,r.kt)(o.Z,{value:"resultat",label:"R\xe9sultat",mdxType:"TabItem"},(0,r.kt)(m,{workdir:"C:\\",command:"$minou",result:"\nName            Value\n----            -----\nNom             Garfield\nEspece          Felis catus\nPassion         Manger",mdxType:"PowerShellWindow"}))),(0,r.kt)("h3",{id:"comportement-du-hashtable"},"Comportement du ",(0,r.kt)("em",{parentName:"h3"},"HashTable")),(0,r.kt)("p",null,"Un ",(0,r.kt)("em",{parentName:"p"},"HashTable")," n'a pas vraiment le m\xeame comportement qu'un objet PowerShell. Ce type d'objet est en fait une structure de donn\xe9es compos\xe9e de cl\xe9s et de valeurs, comme un dictionnaire."),(0,r.kt)("p",null,"L'exemple suivant montre un tableau de ",(0,r.kt)("em",{parentName:"p"},"HashTable"),", le r\xe9sultat que nous nous attendrions d'avoir lors de l'affichage et le r\xe9sultat r\xe9el."),(0,r.kt)(l.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"code",label:"Code",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},'$minous = @(\n    @{\n        Nom = "Garfield"\n        Espece = "Felis catus"\n        Passion = "Manger"\n    },\n    @{\n        Nom = "Grumpy Cat"\n        Espece = "Felis catus"\n        Passion = "Faire la baboune"\n    }\n)\n'))),(0,r.kt)(o.Z,{value:"resultat_souhaite",label:"R\xe9sultat souhait\xe9",mdxType:"TabItem"},(0,r.kt)(m,{workdir:"C:\\",command:"$minou",result:"\nNom           Espece         Passion\n---           ------         -------\nGarfield      Felis catus    Manger\nGrumpy Cat    Felis catus    Faire la baboune",mdxType:"PowerShellWindow"})),(0,r.kt)(o.Z,{value:"resultat",label:"R\xe9sultat r\xe9el",mdxType:"TabItem"},(0,r.kt)(m,{workdir:"C:\\",command:"$minou",result:"\nName            Value\n----            -----\nPassion         Manger\nNom             Garfield\nEspece          Felis catus\nPassion         Faire la baboune\nNom             Grumpy Cat\nEspece          Felis catus",mdxType:"PowerShellWindow"}))),(0,r.kt)("h2",{id:"objets-personnalis\xe9s-pscustomobject"},"Objets personnalis\xe9s (",(0,r.kt)("em",{parentName:"h2"},"PSCustomObject"),")"),(0,r.kt)("p",null,"Pour cr\xe9er un objet disposant de propri\xe9t\xe9s propres mais se comportant de la m\xeame mani\xe8re que les objets PowerShell, on utilise g\xe9n\xe9ralement le type ",(0,r.kt)("em",{parentName:"p"},"PSCustomObject"),". Ce type repr\xe9sente litt\xe9ralement un objet PowerShell personnalit\xe9, duquel nous d\xe9finissons nous-m\xeame les propri\xe9t\xe9s. Ce type d'objet est con\xe7u pour imiter un objet standard compos\xe9 de propri\xe9t\xe9s et de m\xe9thodes, contrairement au ",(0,r.kt)("em",{parentName:"p"},"HashTable")," qui n'est qu'un dictionnaire servant \xe0 associer des cl\xe9s \xe0 des valeurs. C'est d'ailleurs ce type d'objet que produit la commande ",(0,r.kt)("inlineCode",{parentName:"p"},"Select-Object -Property"),"."),(0,r.kt)("p",null,"On cr\xe9e un objet PSCustomObject de la m\xeame mani\xe8re qu'un ",(0,r.kt)("em",{parentName:"p"},"HashTable"),", \xe0 une diff\xe9rence pr\xe8s: on doit sp\xe9cifier qu'il s'agit du type PSCustomObject."),(0,r.kt)(l.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"code",label:"Code",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},'$minou = [PSCustomObject]@{ \n    Nom = "Garfield"\n    Espece = "Felis catus"\n    Passion = "Manger"\n}\n'))),(0,r.kt)(o.Z,{value:"resultat",label:"R\xe9sultat",mdxType:"TabItem"},(0,r.kt)(m,{workdir:"C:\\",command:"$minou",result:"\nNom           Espece         Passion\n---           ------         -------\nGarfield      Felis catus    Manger",mdxType:"PowerShellWindow"}))),(0,r.kt)("h3",{id:"collections-de-pscustomobject"},"Collections de ",(0,r.kt)("em",{parentName:"h3"},"PSCustomObject")),(0,r.kt)("p",null,"Contrairement aux ",(0,r.kt)("em",{parentName:"p"},"HashTable"),", les ",(0,r.kt)("em",{parentName:"p"},"PSCustomObject")," sont structur\xe9s pour faciliter leur manipulation en collection."),(0,r.kt)(l.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"code",label:"Code",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},'$minous = @(\n    [PSCustomObject]@{\n        Nom = "Garfield"\n        Espece = "Felis catus"\n        Passion = "Manger"\n    },\n    [PSCustomObject]@{\n        Nom = "Grumpy Cat"\n        Espece = "Felis catus"\n        Passion = "Faire la baboune"\n    }\n)\n'))),(0,r.kt)(o.Z,{value:"resultat",label:"R\xe9sultat",mdxType:"TabItem"},(0,r.kt)(m,{workdir:"C:\\",command:"$minous",result:"\nNom           Espece         Passion\n---           ------         -------\nGarfield      Felis catus    Manger\nGrumpy Cat    Felis catus    Faire la baboune",mdxType:"PowerShellWindow"}))),(0,r.kt)("h3",{id:"modifier-une-propri\xe9t\xe9"},"Modifier une propri\xe9t\xe9"),(0,r.kt)("p",null,"Pour modifier une propri\xe9t\xe9 d'un objet ",(0,r.kt)("em",{parentName:"p"},"PSCustomObject"),", on n'a qu'\xe0 lui affecter une nouvelle valeur."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},'$minou.Passion = "Manger de la lasagne"\n')),(0,r.kt)("p",null,"Il faut toutefois que la propri\xe9t\xe9 existe dans l'objet."),(0,r.kt)("h3",{id:"ajouter-des-propri\xe9t\xe9s"},"Ajouter des propri\xe9t\xe9s"),(0,r.kt)("p",null,"Nous avons vu plus haut comment cr\xe9er un objet ",(0,r.kt)("em",{parentName:"p"},"PSCustomObject")," lorsqu'on conna\xeet toutes les propri\xe9t\xe9s de l'objet, et comment affecter une nouvelle valeur \xe0 une propri\xe9t\xe9 existante. Pour cr\xe9er une nouvelle propri\xe9t\xe9 dans l'objet, on peut utiliser la commande ",(0,r.kt)("inlineCode",{parentName:"p"},"Add-Member")," et lui passer en entr\xe9e l'objet \xe0 modifier par le ",(0,r.kt)("em",{parentName:"p"},"pipeline"),"."),(0,r.kt)("p",null,"Pour une propri\xe9t\xe9 simple, on n'a qu'\xe0 cr\xe9er un nouveau membre de type \"NoteProperty\" et lui affecter un nom et une valeur."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},'$minou | Add-Member -MemberType NoteProperty -Name "Couleur" -Value "Roux"\n')),(0,r.kt)("h3",{id:"ajouter-des-m\xe9thodes"},"Ajouter des m\xe9thodes"),(0,r.kt)("p",null,"On peut aussi ajouter d'autres types de membres, dont des m\xe9thodes. Contrairement aux propri\xe9t\xe9s qui retournent un objet stock\xe9 statiquement, les m\xe9thodes permettent d'ex\xe9cuter du code. "),(0,r.kt)("p",null,"Le proc\xe9d\xe9 est semblable \xe0 l'ajout de propri\xe9t\xe9s, \xe0 l'exception qu'on d\xe9finit un membre de type ScriptMethod et qu'on lui sp\xe9cifie un ScriptBlock."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},'$minou | Add-Member -MemberType ScriptMethod -Name "Miauler" -Value { Write-Host "Miaou" }\n')),(0,r.kt)("h2",{id:"splatting"},"Splatting"),(0,r.kt)("p",null,"Le ",(0,r.kt)("em",{parentName:"p"},"splatting")," est une technique qui consiste \xe0 identifier les arguments \xe0 passer dans une commande \xe0 l'int\xe9rieur d'un objet."),(0,r.kt)("p",null,"Il suffit de d\xe9finir un HashTable compos\xe9 des arguments, dont la cl\xe9 repr\xe9sente le nom de l'argument et la valeur, la valeur de l'argument. Dans le cas des arguments de type ",(0,r.kt)("em",{parentName:"p"},"switch"),", on leur affecte la valeur ",(0,r.kt)("inlineCode",{parentName:"p"},"$true"),". Puis, il suffit se passer cette variable \xe0 la commande, en utilisant la forme ",(0,r.kt)("inlineCode",{parentName:"p"},"@Nomdelavariable"),"."),(0,r.kt)(l.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"avec",label:"Avec splatting",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},'$splat = @{\n    FilePath = "C:\\Windows\\Notepad.exe"\n    ArgumentList = "C:\\minou\\allo.txt"\n    WorkingDirectory = "C:\\"\n    PassThru = $true\n    WindowStyle = "Maximized"\n    Wait = $true\n    Verb = "Runas"\n}\n\nStart-Process @splat\n'))),(0,r.kt)(o.Z,{value:"sans",label:"Sans splatting",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},'Start-Process -FilePath "C:\\Windows\\Notepad.exe" -ArgumentList "C:\\minou\\allo.txt" -WorkingDirectory "C:\\" -PassThru -WindowStyle "Maximized" -Wait -Verb "Runas"\n')))))}f.isMDXComponent=!0}}]);
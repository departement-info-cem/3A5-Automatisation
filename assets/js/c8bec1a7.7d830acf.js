"use strict";(self.webpackChunkdepinfo_template=self.webpackChunkdepinfo_template||[]).push([[256],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>k});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var u=a.createContext({}),s=function(e){var t=a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=s(e.components);return a.createElement(u.Provider,{value:t},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,u=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),m=s(n),c=r,k=m["".concat(u,".").concat(c)]||m[c]||d[c]||i;return n?a.createElement(k,l(l({ref:t},p),{},{components:n})):a.createElement(k,l({ref:t},p))}));function k(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=c;var o={};for(var u in t)hasOwnProperty.call(t,u)&&(o[u]=t[u]);o.originalType=e,o[m]="string"==typeof e?e:r,l[1]=o;for(var s=2;s<i;s++)l[s]=n[s];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},5162:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(7294),r=n(6010);const i={tabItem:"tabItem_Ymn6"};function l(e){let{children:t,hidden:n,className:l}=e;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(i.tabItem,l),hidden:n},t)}},4866:(e,t,n)=>{n.d(t,{Z:()=>C});var a=n(7462),r=n(7294),i=n(6010),l=n(2466),o=n(6550),u=n(1980),s=n(7392),p=n(12);function m(e){return function(e){return r.Children.map(e,(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:r}}=e;return{value:t,label:n,attributes:a,default:r}}))}function d(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??m(n);return function(e){const t=(0,s.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function c(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function k(e){let{queryString:t=!1,groupId:n}=e;const a=(0,o.k6)(),i=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,u._X)(i),(0,r.useCallback)((e=>{if(!i)return;const t=new URLSearchParams(a.location.search);t.set(i,e),a.replace({...a.location,search:t.toString()})}),[i,a])]}function N(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,i=d(e),[l,o]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!c({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:i}))),[u,s]=k({queryString:n,groupId:a}),[m,N]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,i]=(0,p.Nk)(n);return[a,(0,r.useCallback)((e=>{n&&i.set(e)}),[n,i])]}({groupId:a}),b=(()=>{const e=u??m;return c({value:e,tabValues:i})?e:null})();(0,r.useLayoutEffect)((()=>{b&&o(b)}),[b]);return{selectedValue:l,selectValue:(0,r.useCallback)((e=>{if(!c({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);o(e),s(e),N(e)}),[s,N,i]),tabValues:i}}var b=n(2389);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function v(e){let{className:t,block:n,selectedValue:o,selectValue:u,tabValues:s}=e;const p=[],{blockElementScrollPositionUntilNextRender:m}=(0,l.o5)(),d=e=>{const t=e.currentTarget,n=p.indexOf(t),a=s[n].value;a!==o&&(m(t),u(a))},c=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const n=p.indexOf(e.currentTarget)+1;t=p[n]??p[0];break}case"ArrowLeft":{const n=p.indexOf(e.currentTarget)-1;t=p[n]??p[p.length-1];break}}t?.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":n},t)},s.map((e=>{let{value:t,label:n,attributes:l}=e;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:o===t?0:-1,"aria-selected":o===t,key:t,ref:e=>p.push(e),onKeyDown:c,onClick:d},l,{className:(0,i.Z)("tabs__item",g.tabItem,l?.className,{"tabs__item--active":o===t})}),n??t)})))}function f(e){let{lazy:t,children:n,selectedValue:a}=e;const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=i.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},i.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function h(e){const t=N(e);return r.createElement("div",{className:(0,i.Z)("tabs-container",g.tabList)},r.createElement(v,(0,a.Z)({},e,t)),r.createElement(f,(0,a.Z)({},e,t)))}function C(e){const t=(0,b.Z)();return r.createElement(h,(0,a.Z)({key:String(t)},e))}},5706:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>u,default:()=>b,frontMatter:()=>o,metadata:()=>s,toc:()=>m});var a=n(7462),r=(n(7294),n(3905)),i=n(4866),l=n(5162);const o={},u="Rencontre 9 - Utilisateurs locaux et commentaires",s={unversionedId:"cours/r09",id:"cours/r09",title:"Rencontre 9 - Utilisateurs locaux et commentaires",description:"1. Gestion des utilisateurs locaux sous Windows",source:"@site/docs/cours/r09.md",sourceDirName:"cours",slug:"/cours/r09",permalink:"/3A5-Automatisation/cours/r09",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Rencontre 8 - Erreurs",permalink:"/3A5-Automatisation/cours/r08"},next:{title:"Rencontre 10 - Travail sur le TP1",permalink:"/3A5-Automatisation/cours/r10"}},p={},m=[{value:"Gestion des utilisateurs locaux",id:"gestion-des-utilisateurs-locaux",level:2},{value:"Consulter les utilisateurs existants",id:"consulter-les-utilisateurs-existants",level:3},{value:"Cr\xe9ation d&#39;un nouvel utilisateur",id:"cr\xe9ation-dun-nouvel-utilisateur",level:3},{value:"Groupes locaux",id:"groupes-locaux",level:3},{value:"Commentaires",id:"commentaires",level:2},{value:"Commentaires de ligne",id:"commentaires-de-ligne",level:3},{value:"Blocs de commentaires",id:"blocs-de-commentaires",level:3},{value:"Aide bas\xe9e sur les commentaires",id:"aide-bas\xe9e-sur-les-commentaires",level:3},{value:"Git, GitHub et GitHub Classroom",id:"git-github-et-github-classroom",level:2},{value:"Git",id:"git",level:3},{value:"GitHub",id:"github",level:3},{value:"GitHub Classroom",id:"github-classroom",level:3}],d=(c="PowerShellWindow",function(e){return console.warn("Component "+c+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",e)});var c;const k={toc:m},N="wrapper";function b(e){let{components:t,...n}=e;return(0,r.kt)(N,(0,a.Z)({},k,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"rencontre-9---utilisateurs-locaux-et-commentaires"},"Rencontre 9 - Utilisateurs locaux et commentaires"),(0,r.kt)("admonition",{title:"R\xe9sum\xe9 de la s\xe9ance",type:"note"},(0,r.kt)(i.Z,{mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"deroulement",label:"\ud83d\udc68\u200d\ud83c\udfeb D\xe9roulement du cours",mdxType:"TabItem"},(0,r.kt)("ol",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ol"},"Gestion des utilisateurs locaux sous Windows"),(0,r.kt)("li",{parentName:"ol"},"Commentaires et rubriques d'aide bas\xe9es sur les commentaires"),(0,r.kt)("li",{parentName:"ol"},"Utilisation des fonctionnalit\xe9s de d\xe9bogage dans VS Code"),(0,r.kt)("li",{parentName:"ol"},"Utilisation de Git, GitHub et GitHub Classroom"),(0,r.kt)("li",{parentName:"ol"},"Pr\xe9sentation du TP1"))),(0,r.kt)(l.Z,{value:"exercices",label:"\ud83d\udcbb Exercices \xe0 compl\xe9ter",mdxType:"TabItem"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"L'exercice de remise sur GitHub Classroom (TP0)"),(0,r.kt)("li",{parentName:"ul"},"Les exercices que vous n'avez pas encore compl\xe9t\xe9s"),(0,r.kt)("li",{parentName:"ul"},"Travail sur le TP1"))),(0,r.kt)(l.Z,{value:"ressources",label:"\ud83d\udcda Ressources \xe0 consulter",mdxType:"TabItem"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"La pr\xe9sentation PowerPoint est sur le Teams du cours, sous le canal G\xe9n\xe9ral > Fichiers > Supports de cours."),(0,r.kt)("li",{parentName:"ul"},"Des tutoriels pour GitHub et LabInfo sont dans la biblioth\xe8que de contenu sur OneNote."))))),(0,r.kt)("h2",{id:"gestion-des-utilisateurs-locaux"},"Gestion des utilisateurs locaux"),(0,r.kt)("p",null,"\xc0 l'exception des contr\xf4leurs de domaine, toutes les machines Windows, qu'elles soient d'une \xe9dition client (Windows 10 / 11) ou serveur, poss\xe8dent des utilisateurs locaux. Comme vous l'avez vu dans le cours de syst\xe8mes d'exploitation, les utilisateurs locaux peuvent \xeatre g\xe9r\xe9s au moyen du composant enfichable \"Utilisateurs et groupes locaux\" dans une console MMC (accessible par lusrmgr.msc ou compmgmt.msc). Par d\xe9faut, lorsqu'on installe Windows, un certain nombre de comptes utilisateurs sont cr\xe9\xe9s, dont ",(0,r.kt)("em",{parentName:"p"},"Administrateur")," et ",(0,r.kt)("em",{parentName:"p"},"Invit\xe9"),"."),(0,r.kt)("p",null,"Windows poss\xe8de \xe9galement un ensemble de groupes locaux pr\xe9d\xe9finis. On peut ajouter des comptes (locaux ou domaine) dans un groupe local. Certains groupes poss\xe8dent des privil\xe8ges particuliers, comme le groupe ",(0,r.kt)("strong",{parentName:"p"},"Administrateurs"),"; tous les comptes utilisateurs membres de ce groupe disposent du ",(0,r.kt)("strong",{parentName:"p"},"privil\xe8ge d'\xe9l\xe9vation"),' ("ex\xe9cuter en tant qu\'admin"). Les membres du groupe ',(0,r.kt)("strong",{parentName:"p"},"Utilisateurs"),", quant \xe0 eux, disposent du privil\xe8ge de ",(0,r.kt)("strong",{parentName:"p"},"d\xe9marrage de session locale"),". "),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Un utilisateur qui n'est pas membre d'un de ces groupes ne sera pas autoris\xe9 \xe0 d\xe9marrer une session.")),(0,r.kt)("p",null,"On peut utiliser PowerShell pour contr\xf4ler les utilisateurs locaux, les groupes locaux ainsi que l'appartenance aux groupes locaux. PowerShell offre pour ce faire un module ",(0,r.kt)("inlineCode",{parentName:"p"},"Microsoft.PowerShell.LocalAccounts")," qui renferme plusieurs commandes, notamment:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Add-LocalGroupMember")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Disable-LocalUser")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Enable-LocalUser")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Get-LocalGroup")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Get-LocalGroupMember")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Get-LocalUser")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"New-LocalGroup")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"New-LocalUser")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Remove-LocalGroup")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Remove-LocalGroupMember")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Remove-LocalUser")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Rename-LocalGroup")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Rename-LocalUser")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Set-LocalGroup")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Set-LocalUser"))),(0,r.kt)("h3",{id:"consulter-les-utilisateurs-existants"},"Consulter les utilisateurs existants"),(0,r.kt)("p",null,"La commande Get-LocalUser permet d'obtenir la liste des utilisateurs locaux. Elle retourne un ou plusieurs objets de types ",(0,r.kt)("inlineCode",{parentName:"p"},"[Microsoft.PowerShell.Commands.LocalUser]")," qui d\xe9crivent un compte utilisateur local."),(0,r.kt)(d,{workdir:"C:\\",command:"Get-LocalUser",result:"\nName               Enabled Description \n----               ------- -----------\nAdministrateur     True    Compte d\u2019utilisateur d\u2019administration\nDefaultAccount     False   Compte utilisateur g\xe9r\xe9 par le syst\xe8me.\nInvit\xe9             False   Compte d\u2019utilisateur invit\xe9\npaul               True    Boss de la compagnie\nWDAGUtilityAccount False   Compte d\u2019utilisateur g\xe9r\xe9 et utilis\xe9 par le syst...",mdxType:"PowerShellWindow"}),(0,r.kt)("p",null,"Ces objets poss\xe8dent plusieurs informations sur le compte utilisateur. On peut les voir en explorant la structure de l'objet, par exemple avec ",(0,r.kt)("inlineCode",{parentName:"p"},"Select-Object *"),"."),(0,r.kt)(d,{workdir:"C:\\",command:"Get-LocalUser -Name 'paul' | Select-Object *",result:"\nAccountExpires         : 2023-05-12 20:06:27\nDescription            : Boss de la compagnie\nEnabled                : True\nFullName               : Paul Meilleur\nPasswordChangeableDate : 2023-04-13 20:06:27\nPasswordExpires        : 2023-05-24 20:06:27\nUserMayChangePassword  : True\nPasswordRequired       : False\nPasswordLastSet        : 2023-04-12 20:06:27\nLastLogon              :\nName                   : paul\nSID                    : S-1-5-21-3297567932-2200011671-69726474-1001\nPrincipalSource        : Local\nObjectClass            : Utilisateur",mdxType:"PowerShellWindow"}),(0,r.kt)("h3",{id:"cr\xe9ation-dun-nouvel-utilisateur"},"Cr\xe9ation d'un nouvel utilisateur"),(0,r.kt)("p",null,"La commande ",(0,r.kt)("inlineCode",{parentName:"p"},"New-LocalUser")," cr\xe9e un utilisateur local et retourne l'objet d\xe9crivant cet utilisateur dans le pipeline (comme il est d'usage par la majorit\xe9 des commandes exploitant le verbe ",(0,r.kt)("inlineCode",{parentName:"p"},"New-"),"). Il faut \xe9videmment que la session PowerShell soit \xe9lev\xe9e en tant qu'admin pour apporter des modifications sur les utilisateurs locaux."),(0,r.kt)("p",null,"La commande offre un certains nombres de param\xe8tres pour sp\xe9cifier les diff\xe9rentes propri\xe9t\xe9s du compte \xe0 cr\xe9er."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Param\xe8tre"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Name")),(0,r.kt)("td",{parentName:"tr",align:null},"String"),(0,r.kt)("td",{parentName:"tr",align:null},"Le nom d'utilisateur (",(0,r.kt)("em",{parentName:"td"},"login"),")")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"FullName")),(0,r.kt)("td",{parentName:"tr",align:null},"String"),(0,r.kt)("td",{parentName:"tr",align:null},"Le nom complet (pr\xe9nom nom)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Description")),(0,r.kt)("td",{parentName:"tr",align:null},"String"),(0,r.kt)("td",{parentName:"tr",align:null},"Le champ Description")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"AccountExpires")),(0,r.kt)("td",{parentName:"tr",align:null},"DateTime"),(0,r.kt)("td",{parentName:"tr",align:null},"La date d'expiration de l'utilisateur")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"AccountNeverExpires")),(0,r.kt)("td",{parentName:"tr",align:null},"Switch"),(0,r.kt)("td",{parentName:"tr",align:null},"Indique que le compte n'expire jamais")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Disabled")),(0,r.kt)("td",{parentName:"tr",align:null},"Switch"),(0,r.kt)("td",{parentName:"tr",align:null},"Indique que le compte est d\xe9sactiv\xe9 d\xe8s sa cr\xe9ation")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Password")),(0,r.kt)("td",{parentName:"tr",align:null},"SecureString"),(0,r.kt)("td",{parentName:"tr",align:null},"Le mot de passe de l'utilisateur")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"NoPassword")),(0,r.kt)("td",{parentName:"tr",align:null},"Switch"),(0,r.kt)("td",{parentName:"tr",align:null},"Indique que le compte n'a aucun mot de passe (pas tr\xe8s s\xe9curitaire!)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"PasswordNeverExpires")),(0,r.kt)("td",{parentName:"tr",align:null},"Switch"),(0,r.kt)("td",{parentName:"tr",align:null},"Indique que le mot de passe n'expire jamais")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"UserMayNotChangePassword")),(0,r.kt)("td",{parentName:"tr",align:null},"Switch"),(0,r.kt)("td",{parentName:"tr",align:null},"Indique que l'utilisateur n'a pas le droit de modifier son mot de passe")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"WhatIf")),(0,r.kt)("td",{parentName:"tr",align:null},"Switch"),(0,r.kt)("td",{parentName:"tr",align:null},"Fait en sorte que la commande ne cr\xe9e pas l'utilisateur pour vrai (utile pour tester)")))),(0,r.kt)("p",null,":::Info\nLe mot de passe est de type ",(0,r.kt)("inlineCode",{parentName:"p"},"[SecureString]")," et pas une cha\xeene de caract\xe8res normale. Ce qui fait qu'on doit d'abord convertir la cha\xeene de caract\xe8re en cha\xeene s\xe9curis\xe9e. On peut le faire au moyen de la commande ",(0,r.kt)("inlineCode",{parentName:"p"},"ConvertTo-SecureString"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},"$securepasswd = 'Passw0rd' | ConvertTo-SecureString -AsPlainText -Force\n")),(0,r.kt)("p",null,":::"),(0,r.kt)("p",null,"Voici un exemple de cr\xe9ation d'un compte utilisateur local (en utilisant le ",(0,r.kt)("em",{parentName:"p"},"splatting"),"):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},'$NouvelUtilisateurSplat = @{\n    Name = "paul"\n    FullName = "Paul Meilleur"\n    Description = "Boss de la compagnie"\n    AccountExpires = (Get-Date).AddDays(30)   # Dans 30 jours\n    Password = ConvertTo-SecureString -String "Passw0rd" -AsPlainText -Force\n}\n\nNew-LocalUser @NouvelUtilisateurSplat\n')),(0,r.kt)("admonition",{type:"danger"},(0,r.kt)("p",{parentName:"admonition"},"On ne devrait jamais mettre des mots de passe en clair dans un script, ni stocker un mot de passe dans une variable en texte clair!!! Voici quelques options pour l'\xe9viter:"),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"Cr\xe9er un algorithme qui choisit automatiquement un mot de passe en fonction d'information provenant de l'ext\xe9rieur"),(0,r.kt)("li",{parentName:"ul"},"Utiliser la commande ",(0,r.kt)("inlineCode",{parentName:"li"},"Read-Host -AsSecureString")," pour demander \xe0 l'utilisateur d'entrer un mot de passe (dont la saisie est masqu\xe9e"),(0,r.kt)("li",{parentName:"ul"},"Utiliser ",(0,r.kt)("inlineCode",{parentName:"li"},"Get-Credential")," pour fournir un nom d'utilisateur et un mot de passe. Nous verrons plus loin cette commande lorsque nous traiterons de l'authentification par PowerShell."))),(0,r.kt)("h3",{id:"groupes-locaux"},"Groupes locaux"),(0,r.kt)("p",null,"\xc0 l'instar des utilisateurs, on peut conna\xeetre les groupes locaux au moyen de la commande ",(0,r.kt)("inlineCode",{parentName:"p"},"Get-LocalGroup"),"."),(0,r.kt)("p",null,"Pour cr\xe9er un groupe local, on utilise la commande ",(0,r.kt)("inlineCode",{parentName:"p"},"New-LocalGroup"),". L\xe0 encore, cette commande ne fonctionne que dans une session PowerShell \xe9lev\xe9e."),(0,r.kt)("p",null,"Pour obtenir les membres d'un groupe, on peut utiliser la commande ",(0,r.kt)("inlineCode",{parentName:"p"},"Get-LocalGroupMember"),"."),(0,r.kt)(d,{workdir:"C:\\",command:"Get-LocalGroupMember -Group 'Administrateurs'",result:"\nObjectClass Name                    PrincipalSource\n----------- ----                    ---------------\nUtilisateur PC0001\\Administrateur   Local\nUtilisateur PC0001\\bob              Local\nUtilisateur PC0001\\paul             Local\nUtilisateur PC0001\\pierre           Local\nGroupe      MINOU\\Admins du domaine ActiveDirectory\nUtilisateur MINOU\\paul.meilleur     ActiveDirectory",mdxType:"PowerShellWindow"}),(0,r.kt)("p",null,"Pour ajouter un utilisateur dans un groupe, on utilise la commande ",(0,r.kt)("inlineCode",{parentName:"p"},"Add-LocalGroupMember"),". Cette commande prend en param\xe8tre ",(0,r.kt)("inlineCode",{parentName:"p"},"-Member")," qui d\xe9signe le membre \xe0 ajouter, ainsi que ",(0,r.kt)("inlineCode",{parentName:"p"},"-Group")," qui d\xe9signe le groupe dans lequel l'ajouter."),(0,r.kt)("p",null,'Add-LocalGroupMember \u2013Member "Paul" -Group "Administrateurs"'),(0,r.kt)("p",null,"Cette commande admet qu'on passe le membre \xe0 ajouter par le pipeline en entr\xe9e."),(0,r.kt)("p",null,'Get-LocalUser -Name "Paul" | Add-LocalGroupMember -Group "Administrateurs"'),(0,r.kt)("p",null,"Cela permet, entre autres, de cr\xe9er un compte et l'ajouter imm\xe9diatement \xe0 un groupe, puisque la cr\xe9ation g\xe9n\xe8re un objet repr\xe9sentant l'utilisateur."),(0,r.kt)("p",null,'New-LocalUser -Name "Zoe" -NoPassword | Add-LocalGroupMember -Group "Utilisateurs"'),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"On peut aussi ajouter des utilisateurs ou des groupes du domaine comme membre d'un groupe local. Pour ce faire, on n'a qu'\xe0 sp\xe9cifier le sAMAccountName du principal de s\xe9curit\xe9 du domaine. Si la machine dispose d'une relation d'approbation avec le domaine du compte, celui-ci sera ajout\xe9 comme membre au groupe."),(0,r.kt)("p",{parentName:"admonition"},'Add-LocalGroupMember \u2013Member "DOMAINE\\paul.meilleur" -Group "Administrateurs"')),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Le nom des groupes est diff\xe9rent sur les versions anglaise et fran\xe7aise de Windows. Pour que le script fonctionne ind\xe9pendamment de la langue du syst\xe8me, on peut utiliser le SID du groupe plut\xf4t que son nom. Le SID est un num\xe9ro d'identification unique, et dans le cas des groupes pr\xe9d\xe9finis dans Windows (Administrateurs, Utilisateurs), il est toujours le m\xeame peu importe la langue."),(0,r.kt)("p",{parentName:"admonition"},"On peut voir les SID des groupes avec la commande suivante:"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},"Get-LocalGroup | Select-Object -Property Name, SID\n")),(0,r.kt)("p",{parentName:"admonition"},"Voici quelques SID bien connus:"),(0,r.kt)("table",{parentName:"admonition"},(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Nom fran\xe7ais"),(0,r.kt)("th",{parentName:"tr",align:null},"Nom anglais"),(0,r.kt)("th",{parentName:"tr",align:null},"SID"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Administrateurs"),(0,r.kt)("td",{parentName:"tr",align:null},"Administrators"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"S-1-5-32-544"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Utilisateurs"),(0,r.kt)("td",{parentName:"tr",align:null},"Users"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"S-1-5-32 545"))))),(0,r.kt)("p",{parentName:"admonition"},"Par exemple, pour ajouter un utilisateur au groupe des administrateurs:"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},'$MonUtilisateur | Add-LocalGroupMember -SID "S-1-5-32-544"\n'))),(0,r.kt)("h2",{id:"commentaires"},"Commentaires"),(0,r.kt)("p",null,"Au d\xe9but de la session, nous avons vu les diff\xe9rents types de commentaires en PowerShell. Les commentaires sont des parties du texte compris dans le fichier script qui sont ignor\xe9s par l'interpr\xe9teur. Ils servent principalement \xe0 documenter le code."),(0,r.kt)("h3",{id:"commentaires-de-ligne"},"Commentaires de ligne"),(0,r.kt)("p",null,"Les commentaires de ligne sont identifi\xe9s par le caract\xe8re ",(0,r.kt)("inlineCode",{parentName:"p"},"#"),". D\xe8s que ce caract\xe8re est rencontr\xe9 sur une ligne de texte, le reste de la ligne n'est pas interpr\xe9t\xe9. On peut l'utiliser au d\xe9but de la ligne, ou apr\xe8s une commande."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},"# Ceci est un exemple de commentaire de ligne\nGet-ChildItem -Path $env:Windir    # Voici un autre commentaire\n")),(0,r.kt)("h3",{id:"blocs-de-commentaires"},"Blocs de commentaires"),(0,r.kt)("p",null,"Les blocs de commentaires sont utiles lorsque plusieurs lignes cons\xe9cutives doivent \xeatre mises en commentaire. On peut toujours faire d\xe9buter plusieurs lignes par le caract\xe8re ",(0,r.kt)("inlineCode",{parentName:"p"},"#"),", mais on peut aussi mettre plusieurs lignes entre ",(0,r.kt)("inlineCode",{parentName:"p"},"<#")," et ",(0,r.kt)("inlineCode",{parentName:"p"},"#>"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},"# Voici plusieurs\n# lignes En\n# commentaires\n\n<#\nOu encore on peut\n\xe9crire un bloc de\ncommentaires comme \xe7a.\n#>\n")),(0,r.kt)("h3",{id:"aide-bas\xe9e-sur-les-commentaires"},"Aide bas\xe9e sur les commentaires"),(0,r.kt)("p",null,"Nous avons vu qu'il est possible d'obtenir de l'aide sur une commande gr\xe2ce \xe0 la commande Get-Help. On peut sp\xe9cifier, gr\xe2ce \xe0 des commentaires le contenu de la rubrique d'aide d'un script ou une fonction."),(0,r.kt)("p",null,"Pour ce faire, il suffit de cr\xe9er un bloc de commentaires, entre ",(0,r.kt)("inlineCode",{parentName:"p"},"<#")," et ",(0,r.kt)("inlineCode",{parentName:"p"},"#>")," au d\xe9but ou \xe0 la fin du script ou de la fonction, et de sp\xe9cifier le contenu des diff\xe9rentes rubriques dans des sections correspondantes. Voici les principales:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Section"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},".SYNOPSIS"),(0,r.kt)("td",{parentName:"tr",align:null},"R\xe9sum\xe9 de la fonctionnalit\xe9 du script ou de la fonction.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},".DESCRIPTION"),(0,r.kt)("td",{parentName:"tr",align:null},"Description plus d\xe9taill\xe9e du script ou de la fonction.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},".PARAMETER ",(0,r.kt)("em",{parentName:"td"},"NomDuParam\xe8tre")),(0,r.kt)("td",{parentName:"tr",align:null},"Fournit une description \xe0 un param\xe8tre. Il doit y en avoir un pour chaque param\xe8tre.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},".INPUTS"),(0,r.kt)("td",{parentName:"tr",align:null},"D\xe9crit le type et la nature des donn\xe9es trait\xe9es en entr\xe9e par pipeline.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},".OUTPUTS"),(0,r.kt)("td",{parentName:"tr",align:null},"D\xe9crit le type et la nature des donn\xe9es sortie sur le pipeline.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},".EXAMPLE"),(0,r.kt)("td",{parentName:"tr",align:null},"Donne un exemple d'utilisation ainsi que son r\xe9sultat. On peut fournir plusieurs exemples.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},".NOTES"),(0,r.kt)("td",{parentName:"tr",align:null},"On peut fournir des notes suppl\xe9mentaires")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},".LINK"),(0,r.kt)("td",{parentName:"tr",align:null},"On peut fournir un lien URL, par exemple vers une page de documentation")))),(0,r.kt)("p",null,"Il existe aussi ",(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/fr-ca/powershell/module/microsoft.powershell.core/about/about_comment_based_help?view=powershell-5.1"},"d'autres sections")," que l'on peut ajouter \xe0 un bloc de commentaires."),(0,r.kt)("p",null,"Voici un exemple d'un script ",(0,r.kt)("inlineCode",{parentName:"p"},"RepeteChaine.ps1")," qui impl\xe9mente une rubrique d'aide bas\xe9e sur les commentaires:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},"[CmdletBinding()]\nParam(\n    [Parameter(Mandatory,ValueFromPipeline)]\n    [string] $Chaine,\n\n    [Parameter(Mandatory)]\n    [int] $R\xe9p\xe9titions\n)\n\n$Chaine * $R\xe9p\xe9titions\n\n<#\n.SYNOPSIS\nR\xe9p\xe8te une cha\xeene de texte un certain nombre de fois.\n.DESCRIPTION\nCette fonction retourne une cha\xeene de caract\xe8res correspondant \xe0 la r\xe9p\xe9tition de la cha\xeene d'entr\xe9e un certain nombre de fois.\n.PARAMETER Chaine\nSp\xe9cifie la cha\xeene de caract\xe8res \xe0 r\xe9p\xe9ter.\n.PARAMETER R\xe9p\xe9titions\nSp\xe9cifie le nombre de r\xe9p\xe9titions.\n.INPUTS\nSystem.String. Ce script adbet la cha\xeene de caract\xe8res \xe0 r\xe9p\xe9ter par le pipeline.\n.OUTPUTS\nSystem.String. Ce script retourne une cha\xeene r\xe9sultant de la r\xe9p\xe9tition de la cha\xeene d'entr\xe9e\n.EXAMPLE\nPS> .\\RepeteChaine.ps1 -Chaine \"abc\" -R\xe9p\xe9titions 3\nabcabcabc\n.EXAMPLE\nPS> \"abc\" | .\\RepeteChaine.ps1 -R\xe9p\xe9titions 3\nabcabcabc\n.NOTES\nCe script est un exemple d'utilisation de l'aide bas\xe9e sur les commentaires\n.LINK\nhttps://learn.microsoft.com/fr-ca/powershell/module/microsoft.powershell.core/about/about_comment_based_help?view=powershell-5.1\n#>\n")),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Il est possible de sp\xe9cifier le texte d'aide sp\xe9cifiques aux param\xe8tres directement dans la d\xe9claration de ces derniers. On n'a alors plus besoin de les d\xe9finir dans le bloc de commentaires. Si les descriptions des param\xe8tres sont courtes, \xe7a peut \xeatre pratique."),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},"Param(\n    #Sp\xe9cifie la cha\xeene de caract\xe8res \xe0 r\xe9p\xe9ter.\n    [Parameter(Mandatory,ValueFromPipeline)]\n    [string] $Chaine,\n\n    #Sp\xe9cifie le nombre de r\xe9p\xe9titions.\n    [Parameter(Mandatory)]\n    [int] $R\xe9p\xe9titions\n)\n"))),(0,r.kt)("h2",{id:"git-github-et-github-classroom"},"Git, GitHub et GitHub Classroom"),(0,r.kt)("p",null,"Vous avez peut-\xeatre entendu parler de Git. Il s'agit d'une solution de gestion du code source. Dans les \xe9quipes de d\xe9veloppement logiciel, Git est tr\xe8s souvent utilis\xe9 pour g\xe9rer les fichiers composant la solution."),(0,r.kt)("h3",{id:"git"},"Git"),(0,r.kt)("p",null,"Le logiciel Git a \xe9t\xe9 cr\xe9\xe9 par Linus Torvalds, le cr\xe9ateur de Linux. Il permet de g\xe9rer et contr\xf4ler l'\xe9volution d'une solution logicielle. On peut le t\xe9l\xe9charger gratuitement sur le site ",(0,r.kt)("a",{parentName:"p",href:"https://git-scm.com/"},"https://git-scm.com/"),"."),(0,r.kt)("p",null,"Lorsqu'on travaille avec Git, on doit d\xe9finir un ",(0,r.kt)("strong",{parentName:"p"},"d\xe9p\xf4t")," (aussi appel\xe9 ",(0,r.kt)("em",{parentName:"p"},"repository"),", ou ",(0,r.kt)("em",{parentName:"p"},"repo"),") qui contient le ou les fichiers qui composent la solution. Chaque fois qu'on fait une modification significative du code (par exemple, on impl\xe9mente une nouvelle fonctionnalit\xe9), on proc\xe8de \xe0 un ",(0,r.kt)("em",{parentName:"p"},"commit")," et lui donnant une description."),(0,r.kt)("p",null,"Il existe plusieurs services sur le ",(0,r.kt)("em",{parentName:"p"},"cloud")," permettant de conserver un d\xe9p\xf4t. Le plus connu est GitHub, mais il y a aussi GitLabs, BitBucket, et d'autres. Dans ce cours, nous utiliserons GitHub."),(0,r.kt)("h3",{id:"github"},"GitHub"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com"},"GitHub")," est un service qui appartient \xe0 Microsoft et sert \xe0 h\xe9berger des d\xe9p\xf4ts publics ou priv\xe9s. Un d\xe9p\xf4t public h\xe9berge des solutions ",(0,r.kt)("em",{parentName:"p"},"open source"),". N'importe qui peut y avoir acc\xe8s. Pour les projets dont le code source ne doit pas \xeatre divulgu\xe9 au public, on peut cr\xe9er un d\xe9p\xf4t priv\xe9. Sur GitHub, on doit disposer d'un compte professionnel pour avoir le droit de cr\xe9er un d\xe9p\xf4t priv\xe9. Un compte professionnel co\xfbte normalement 4$ US par mois, mais votre statut d'\xe9tudiant vous permet de profiter des avantages pro gratuitement pour la dur\xe9e de vos \xe9tudes."),(0,r.kt)("p",null,"Vous pouvez vous cr\xe9er un compte \xe0 l'adresse ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/login"},"https://github.com/login"),". Suivez les \xe9tapes pour obtenir votre pack d'\xe9tudiant, ce qui vous donnera droit \xe0 des avantages gratuits. Vous aurez \xe0 fournir une preuve de votre statut d'\xe9tudiant."),(0,r.kt)("h3",{id:"github-classroom"},"GitHub Classroom"),(0,r.kt)("p",null,"GitHub Classroom est une solution affili\xe9e \xe0 GitHub qui facilite l'utilisation de GitHub dans un cadre \xe9ducatif. Les travaux pratiques que vous r\xe9aliserez dans ce cours devront \xeatre remis par GitHub Classroom."),(0,r.kt)("p",null,"Lorsqu'un nouveau travail vous sera soumis, votre prof vous communiquera un lien vers GitHub Classroom avec un code. En cliquant sur ce lien, vous devrez vous authentifier avec votre compte GitHub."),(0,r.kt)("p",null,"Si c'est le premier travail du cours, le site vous demandera de lier votre compte \xe0 votre nom. Vous n'aurez \xe0 faire ceci qu'une seule fois par cours."),(0,r.kt)("p",null,"Ensuite, acceptez le travail. Cela cr\xe9era pour vous une copie du d\xe9p\xf4t mod\xe8le qui comprend tous les fichiers relatifs au travail \xe0 r\xe9aliser. Seuls vous et votre professeur aurez acc\xe8s \xe0 votre d\xe9p\xf4t."),(0,r.kt)("p",null,"Ce d\xe9p\xf4t vous \xe9tant r\xe9serv\xe9, vous pourrez synchroniser vos fichiers et proc\xe9der \xe0 la remise de vos travaux. Votre professeur pourra vous donner des commentaires et de la r\xe9troaction."))}b.isMDXComponent=!0}}]);